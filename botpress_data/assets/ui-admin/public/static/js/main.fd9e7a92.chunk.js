(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{187:function(e,t,a){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var r=n(a(817)),s=n(a(818)),o=["cpu.usage","mem.usage"],l=["requests.count","errors.count","warnings.count","eventsIn.count","eventsOut.count"];t.groupEntriesByTime=function(e,t){if(e&&e.length){var a=s.default(t),n=e[0].ts;return r.default.groupBy(e,function(e){return e.ts-n<=a?n:n=e.ts})}},t.mergeEntriesByTime=function(e,t){return r.default.values(r.default.mapValues(e,function(e,a){return i(e,a,t)}))};var i=function(e,t,a){var n={},s={},i=!0,c=!1,u=void 0;try{for(var d,m=function(){var t=d.value;n[t]=n[t]||{};var a=r.default.filter(e,function(e){return e.host===t});o.forEach(function(e){var o=r.default.sumBy(a,e);r.default.set(n[t],e,r.default.round(o/a.length,2)),r.default.set(s,e,r.default.get(s,e,0)+o)}),l.forEach(function(e){var o=r.default.sumBy(a,e);r.default.set(n[t],e,o),r.default.set(s,e,r.default.get(s,e,0)+o)})},p=a[Symbol.iterator]();!(i=(d=p.next()).done);i=!0)m()}catch(h){c=!0,u=h}finally{try{i||null==p.return||p.return()}finally{if(c)throw u}}return o.forEach(function(t){return r.default.set(s,t,r.default.round(r.default.get(s,t)/e.length,2))}),{ts:+t,hosts:n,summary:s}};t.calculateOverviewForHost=function(e){var t={};return o.forEach(function(a){return r.default.set(t,a,r.default.get(r.default.maxBy(e,a),a))}),l.forEach(function(a){return r.default.set(t,a,r.default.sumBy(e,a))}),t}},402:function(e,t){e.exports="data:image/png;base64,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"},413:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.resourceMatches=function(e,t){var a=/[\/\.]/;(e=e||"").indexOf("*")<0&&(e+=".*");for(var n=e.split(a),r=t.split(a),s=!0,o=0;s&&o<n.length;o++)"*"!==n[o]&&(s=o<r.length&&n[o].toLowerCase()===r[o].toLowerCase());return s};var n={read:"r",write:"w"},r=["r","w"];t.checkRule=function(e,a,s){if(!e)return!1;if(a=a.toLowerCase(),a=n[a]||a,!r.includes(a))throw new Error("Invalid rule operation: ".concat(a));var o=!1,l=!0,i=!1,c=void 0;try{for(var u,d=e[Symbol.iterator]();!(l=(u=d.next()).done);l=!0){var m=u.value,p=m.op;if(!p||p.length<2||p.length>4)throw new Error("Invalid rule operation: ".concat(p));t.resourceMatches(m.res,s)&&(4===p.length?o=p[1]===a?"+"===p[0]:p[3]===a&&"+"===p[2]:3===p.length?o="+"===p[0]:2===p.length&&p[1]===a&&(o="+"===p[0]))}}catch(h){i=!0,c=h}finally{try{l||null==d.return||d.return()}finally{if(i)throw c}}return o},t.checkMultipleRoles=function(e,a,n){if(!e)return!1;for(var r in e)if(t.checkRule(e[r],a,n))return!0;return!1}},414:function(e,t,a){e.exports=a.p+"static/media/loading-circle.eb332664.svg"},429:function(e,t,a){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var r=n(a(380));t.BOTID_REGEX=/^[A-Z0-9]+[A-Z0-9_-]{1,}[A-Z0-9]+$/i,t.isValidBotId=function(e){return t.BOTID_REGEX.test(e)},t.BotCreationSchema=r.default.object().keys({id:r.default.string().regex(t.BOTID_REGEX).required(),name:r.default.string().max(50).allow("").optional(),category:r.default.string().allow(null),description:r.default.string().max(500).allow(""),pipeline_status:{current_stage:{promoted_by:r.default.string(),promoted_on:r.default.date(),id:r.default.string()}},locked:r.default.bool()}),t.BotEditSchema=r.default.object().keys({name:r.default.string().allow("").max(50),category:r.default.string().allow(null),description:r.default.string().max(500).allow(""),disabled:r.default.bool(),private:r.default.bool(),defaultLanguage:r.default.string().min(2).max(3),languages:r.default.array().items(r.default.string().min(2).max(3)),details:{website:r.default.string().uri().optional().allow(""),termsConditions:r.default.string().uri().optional().allow(""),privacyPolicy:r.default.string().uri().optional().allow(""),phoneNumber:r.default.string().max(20).optional().allow(""),emailAddress:r.default.string().email().optional().allow(""),avatarUrl:r.default.string().optional().allow(""),coverPictureUrl:r.default.string().optional().allow("")}})},455:function(e,t,a){e.exports=a(883)},470:function(e,t,a){},548:function(e,t){},550:function(e,t){},582:function(e,t){},583:function(e,t){},640:function(e,t,a){},883:function(e,t,a){"use strict";a.r(t);a(456);var n=a(2),r=a.n(n),s=a(34),o=a.n(s),l=a(96),i=(a(469),a(470),a(4)),c=a.n(i),u=a(7),d=a(87),m=a(920),p=a(925),h=a(924),f=a(28),g=a(95),E=a(15),v=a(16),b=a(18),y=a(17),w=a(19),k=a(885),O=a(886),C=a(887),R=a(888),S=a(889),A=a(890),x=a(60),I=a(9),N=a(185),j=a.n(N),P=a(399),T=a.n(P),B=a(21),M=a.n(B),D=a(400),F=a.n(D),U=a(401),L=function(e){e.location=Object.assign(e.location,{query:F.a.parse(e.location.search)})},V=a.n(U)()({basename:"/admin"});L(V),V.listen(function(){return L(V)});var H=V,K=a(123),z=a.n(K),Y="bp/token",q="bp/workspace",Z="/home";function J(){var e=localStorage.getItem(Y);return e&&JSON.parse(e)||{token:null,expires:0}}function _(e){e?localStorage.setItem(q,e):localStorage.removeItem(q)}function Q(){return localStorage.getItem(q)}function W(){localStorage.removeItem(Y),H.replace(Z),window.location.reload()}var G=function(){function e(){var t=this;Object(E.a)(this,e),this.login=function(){var e=Object(u.a)(c.a.mark(function e(a,n){var r,s,o,l,i,u,d;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=a.email,s=a.password,o=a.newPassword,!t.isAuthenticated()){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,le.getAnonymous({toastErrors:!1}).post("/auth"+n,{email:r,password:s,newPassword:o});case 5:return l=e.sent,i=l.data,u=i.payload.token,t.setSession({expiresIn:7200,idToken:u}),e.next=11,t.setupWorkspace();case 11:(d=H.location.query.returnTo)?window.location.replace(d):H.replace(Z);case 13:case"end":return e.stop()}},e,this)}));return function(t,a){return e.apply(this,arguments)}}(),this.getStrategyConfig=function(){var e=Object(u.a)(c.a.mark(function e(t){var a,n,r,s,o,l,i;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,le.getAnonymous().get("/auth/config");case 2:if(a=e.sent,(n=a.data).payload&&n.payload.strategies&&n.payload.strategies.length){e.next=6;break}return e.abrupt("return");case 6:return r=n.payload,s=r.strategies,o=r.isFirstUser,l=t||s[0].strategyId,i=s.find(function(e){return e.strategyId===l}),e.abrupt("return",i&&Object(I.a)({},i,{isFirstUser:o}));case 10:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),this.setupWorkspace=Object(u.a)(c.a.mark(function e(){var t,a;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,le.getSecured().get("/auth/me/workspaces");case 2:if(t=e.sent,(a=t.data)&&a.length){e.next=6;break}throw new Error("You must have access to at least one workspace to login.");case 6:_(Q()||a[0].workspace);case 7:case"end":return e.stop()}},e,this)})),this.register=function(){var e=Object(u.a)(c.a.mark(function e(a,n){var r,s,o,l;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=a.email,s=a.password,!t.isAuthenticated()){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,le.getAnonymous({toastErrors:!1}).post("/auth"+n,{email:r,password:s});case 5:return o=e.sent,l=o.data,t.setSession({expiresIn:7200,idToken:l.payload.token}),e.next=10,t.setupWorkspace();case 10:H.replace(Z);case 11:case"end":return e.stop()}},e,this)}));return function(t,a){return e.apply(this,arguments)}}(),this.logout=function(){W()}}return Object(v.a)(e,[{key:"setSession",value:function(e){var t=e.expiresIn;!function(e,t){var a=JSON.stringify({token:e,expires:t||new Date+z()("4h"),time:new Date});localStorage.setItem(Y,a)}(e.idToken,JSON.stringify(1e3*(t||7200)+(new Date).getTime()))}},{key:"parseJwt",value:function(e){var t=e.split(".")[1].replace("-","+").replace("_","/");return JSON.parse(window.atob(t))}},{key:"isAuthenticated",value:function(){var e=J(),t=e.token,a=e.expires;return t&&(new Date).getTime()<a}}]),e}(),X=a(90);a(544);X.initializeApp({apiKey:"AIzaSyBorvBTBW8GbNjJSmhqLbJsu-SvzqTx5OY",authDomain:"botpress-licensing.firebaseapp.com",databaseURL:"https://botpress-licensing.firebaseio.com",projectId:"botpress-licensing",storageBucket:"",messagingSenderId:"355555448753"});var $=function(){var e=Object(u.a)(c.a.mark(function e(){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",X.auth().currentUser.getIdToken());case 1:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),ee=function(){var e=Object(u.a)(c.a.mark(function e(){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",X.auth().signOut());case 1:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),te={timeout:2e3},ae=function(e,t){var a=t.toastErrors,n=(t.addInterceptor,T.a.create(Object(I.a)({},te,e)));return n.interceptors.response.use(function(e){return e},function(e){var t=M.a.get(e,"response.data"),a=M.a.get(t,"errorCode");return a?["BP_0041"].includes(a)?W():j.a.reject(t):j.a.reject(e)}),a&&n.interceptors.response.use(function(e){return e},function(e){var t=M.a.get(e,"response.data.message");return t?ne(t):e.message?ne(e.message):ne("Something wrong happened. Please try again later."),j.a.reject(e)}),n},ne=function(e){l.toast.error(e,{position:l.toast.POSITION.TOP_RIGHT})},re=Object({NODE_ENV:"production",PUBLIC_URL:"/admin"}).REACT_APP_API_URL?{baseURL:"".concat(Object({NODE_ENV:"production",PUBLIC_URL:"/admin"}).REACT_APP_API_URL,"/api/v1")}:{baseURL:"/api/v1"},se=Object({NODE_ENV:"production",PUBLIC_URL:"/admin"}).REACT_APP_LICENSING_SERVER?{baseURL:"".concat(Object({NODE_ENV:"production",PUBLIC_URL:"/admin"}).REACT_APP_LICENSING_SERVER)}:{baseURL:"https://license.botpress.io"},oe=Object({NODE_ENV:"production",PUBLIC_URL:"/admin"}).REACT_APP_STRIPE_PATH?"".concat(Object({NODE_ENV:"production",PUBLIC_URL:"/admin"}).REACT_APP_STRIPE_PATH):"https://botpress.io/stripe",le={getApiPath:function(){return re.baseURL},getSecured:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.token,a=e.toastErrors,n=void 0===a||a,r=e.timeout,s=void 0===r?2e3:r;if(!t){var o=J();t=o&&o.token}return ae(Object(I.a)({timeout:s,headers:{Authorization:"Bearer ".concat(t),"X-BP-Workspace":Q()}},re),{toastErrors:n})},getAnonymous:function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).toastErrors;return ae(re,{toastErrors:void 0===e||e})},getLicensing:function(){var e=Object(u.a)(c.a.mark(function e(){var t,a,n,r,s,o=arguments;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=o.length>0&&void 0!==o[0]?o[0]:{},a=t.toastErrors,n=void 0===a||a,e.next=3,$();case 3:return r=e.sent,(s=ae(Object(I.a)({timeout:1e4,headers:{"X-AUTH-TOKEN":"bearer ".concat(r)}},se),{toastErrors:n})).interceptors.response.use(function(e){return e},function(e){throw!e.response||401!==e.response.status&&403!==e.response.status||ee(),e}),e.abrupt("return",s);case 7:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),getStripePath:function(){return oe}},ie={licensing:null,keys:null,products:null,fetchingKeys:!1,fetchingProducts:!1,licensingAccount:null},ce=function(){return function(){var e=Object(u.a)(c.a.mark(function e(t){var a,n;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,le.getSecured({toastErrors:!1}).get("admin/license/status");case 2:a=e.sent,n=a.data,t({type:"license/FETCH_LICENSING_RECEIVED",licensing:n.payload});case 5:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},ue=a(402),de=a.n(ue),me=a(129),pe=a(41),he=a(268),fe=a(408),ge=a(409),Ee=a(431),ve={users:null,loading:!1,loadingUsers:!1,profile:null,permissions:null},be=function(){return function(){var e=Object(u.a)(c.a.mark(function e(t,a){var n,r,s;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=a(),!n.user.loadingUsers){e.next=3;break}return e.abrupt("return");case 3:return t({type:"user/FETCH_USERS_REQUESTED"}),e.next=6,le.getSecured().get("/admin/users");case 6:r=e.sent,s=r.data,t({type:"user/FETCH_USERS_RECEIVED",users:s.payload});case 9:case"end":return e.stop()}},e,this)}));return function(t,a){return e.apply(this,arguments)}}()},ye=function(){return function(){var e=Object(u.a)(c.a.mark(function e(t){var a,n;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t({type:"user/MY_PROFILE_REQUESTED"}),e.next=3,le.getSecured().get("/auth/me/profile").catch(function(){return W()});case 3:a=e.sent,n=a.data,t({type:"user/MY_PROFILE_RECEIVED",profile:n.payload});case 6:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},we=function(){return function(){var e=Object(u.a)(c.a.mark(function e(t){var a,n;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t({type:"user/MY_PERMISSIONS_REQUESTED"}),e.next=3,le.getSecured().get("/auth/me/permissions");case 3:a=e.sent,n=a.data,t({type:"user/MY_PERMISSIONS_RECEIVED",permissions:n.payload});case 6:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},ke=a(148),Oe=a.n(ke),Ce=function(e){var t,a=e.email,n=e.size,s=e.className,o=Oe.a.createHash("md5").update(a).digest("hex");return t="lg"===n?200:"sm"===n?25:64,r.a.createElement("img",Object.assign({src:"https://www.gravatar.com/avatar/".concat(o,"?size=").concat(t),alt:""},{className:s}))},Re=function(e){function t(e){var a;return Object(E.a)(this,t),(a=Object(b.a)(this,Object(y.a)(t).call(this,e))).auth=void 0,a.gotoServer=function(){a.props.licensing&&a.props.licensing.isPro?a.props.push("/server/monitoring"):a.props.push("/server/license")},a.auth=new G,a}return Object(w.a)(t,e),Object(v.a)(t,[{key:"componentDidMount",value:function(){!this.props.profile&&this.props.fetchProfile()}},{key:"renderPopover",value:function(){var e=this,t=this.props.profile,a=t.email,n=t.fullName,s=t.isSuperAdmin;return r.a.createElement(me.a,{minimal:!0,position:pe.a.BOTTOM,interactionKind:me.b.HOVER},r.a.createElement(he.b,{icon:r.a.createElement(Ce,{email:this.props.profile.email,size:"sm",className:"user-avatar"}),rightIcon:"caret-down",minimal:!0}),r.a.createElement(fe.a,null,r.a.createElement(ge.a,{title:"Signed in as ".concat(n||a)}),s&&r.a.createElement(r.a.Fragment,null,r.a.createElement(ge.a,null),r.a.createElement(Ee.a,{icon:"dashboard",text:"Manage Server",onClick:this.gotoServer}),r.a.createElement(Ee.a,{icon:"console",text:"Configure Debug",onClick:function(){return e.props.push("/server/debug")}}),r.a.createElement(Ee.a,{icon:"globe-network",text:"Languages",onClick:function(){return e.props.push("/server/languages")}})),r.a.createElement(ge.a,null),r.a.createElement(Ee.a,{icon:"user",text:"My account",onClick:function(){return e.props.push("/profile/me")}}),r.a.createElement(Ee.a,{icon:"log-out",text:"Logout",onClick:function(){return e.auth.logout()}})))}},{key:"render",value:function(){return this.props.profile?this.renderPopover():null}}]),t}(n.Component),Se={fetchProfile:ye,push:g.b},Ae=Object(f.b)(function(e){return{profile:e.user.profile,licensing:e.license.licensing}},Se)(Re),xe=function(e){function t(){var e,a;Object(E.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(b.a)(this,(e=Object(y.a)(t)).call.apply(e,[this].concat(r)))).state={isMenuOpen:!0},a.toggleMenu=function(){a.setState({isMenuOpen:!a.state.isMenuOpen})},a}return Object(w.a)(t,e),Object(v.a)(t,[{key:"componentDidMount",value:function(){!this.props.licensing&&this.props.fetchLicensing()}},{key:"render",value:function(){return r.a.createElement(n.Fragment,null,r.a.createElement("header",{className:"bp-header"},r.a.createElement(k.a,{expand:"md"},r.a.createElement(O.a,{href:"/admin"},r.a.createElement("img",{src:de.a,alt:"logo",className:"bp-header__logo"})),r.a.createElement(C.a,{onClick:this.toggleMenu}),r.a.createElement(R.a,{isOpen:this.state.isMenuOpen,navbar:!0},r.a.createElement(S.a,{className:"ml-auto",navbar:!0},r.a.createElement(Ae,null))))),this.renderUnlicensed(),r.a.createElement("div",{className:"bp-main-content"},this.props.children))}},{key:"renderUnlicensed",value:function(){return!this.props.licensing||!this.props.licensing.isPro||"licensed"===this.props.licensing.status?null:r.a.createElement("div",{className:"bp-header__warning"},r.a.createElement(A.a,{href:"/admin/server/license"},r.a.createElement("svg",{viewBox:"0 0 90 82",xmlns:"http://www.w3.org/2000/svg"},r.a.createElement("path",{d:"M88.21 65.042L54.084 5.932A10.53 10.53 0 0 0 44.99.682a10.53 10.53 0 0 0-9.094 5.25L1.467 65.568a10.532 10.532 0 0 0 0 10.5 10.53 10.53 0 0 0 9.094 5.25H79.44c5.79 0 10.5-4.71 10.5-10.5a10.458 10.458 0 0 0-1.73-5.776zm-8.771 9.275H10.561a3.51 3.51 0 0 1-3.031-1.75 3.51 3.51 0 0 1 0-3.5L41.96 9.433a3.509 3.509 0 0 1 3.031-1.75 3.51 3.51 0 0 1 3.031 1.75l34.184 59.208c.042.073.087.145.135.215.393.578.6 1.257.6 1.962a3.507 3.507 0 0 1-3.502 3.499zM45 54.93a3.912 3.912 0 0 0 3.912-3.912V30.687a3.912 3.912 0 0 0-7.824 0v20.331A3.912 3.912 0 0 0 45 54.93zm0 2.295c-1.32 0-2.601.53-3.54 1.46-.93.93-1.46 2.22-1.46 3.54 0 1.31.53 2.6 1.46 3.53a5.078 5.078 0 0 0 3.54 1.47c1.31 0 2.6-.54 3.53-1.47a5.002 5.002 0 0 0 1.47-3.53 5.003 5.003 0 0 0-5-5z",fill:"#FFF",fillRule:"nonzero"})),"Botpress is currently not licensed. Please update your license to re-enable all features."))}}]),t}(n.Component),Ie={fetchLicensing:ce},Ne=Object(f.b)(function(e){return{profile:e.user.profile,licensing:e.license.licensing}},Ie)(xe),je=a(48),Pe=a(183),Te=a(94),Be=a.n(Te),Me=a(891),De=a(892),Fe=a(893),Ue=a(894),Le=a(895),Ve=a(411),He=a(896),Ke=a(897),ze=function(e){function t(){var e,a;Object(E.a)(this,t);for(var s=arguments.length,o=new Array(s),l=0;l<s;l++)o[l]=arguments[l];return(a=Object(b.a)(this,(e=Object(y.a)(t)).call.apply(e,[this].concat(o)))).state={isLoading:!0,isFirstTimeUse:!1,email:"",strategyType:"basic",authEndpoint:null,password:"",passwordExpired:!1,error:null},a.loadAuthConfig=Object(u.a)(c.a.mark(function e(){var t,n,r;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.props.auth.getStrategyConfig(a.props.match.params.strategy);case 2:if(t=e.sent,n=t.isFirstUser,r=Object(Pe.a)(t,["isFirstUser"])){e.next=7;break}return e.abrupt("return",a.setState({isLoading:!1,error:"Invalid strategy"}));case 7:a.setState(Object(I.a)({isLoading:!1,isFirstTimeUse:n},r));case 8:case"end":return e.stop()}},e,this)})),a.login=Object(u.a)(c.a.mark(function e(){var t,n,r,s,o,l=arguments;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=l.length>0&&void 0!==l[0]?l[0]:{},n=t.email,r=t.password,s=t.showError,o=void 0===s||s,a.setState({error:null}),e.prev=2,e.next=5,a.props.auth.login({email:n||a.state.email,password:r||a.state.password},a.state.loginUrl);case 5:e.next=10;break;case 7:e.prev=7,e.t0=e.catch(2),"PasswordExpiredError"===e.t0.type?(a.state.email&&a.state.password||a.setState({email:n,password:r}),a.setState({passwordExpired:!0})):o&&a.setState({error:e.t0.message});case 10:case"end":return e.stop()}},e,this,[[2,7]])})),a.checkErrorMessages=function(){var e=new window.URLSearchParams(window.location.search).get("error");e&&e.length&&a.setState({error:e})},a.handleInputChange=function(e){return a.setState(Object(je.a)({},e.target.name,e.target.value))},a.handleInputKeyPress=function(e){return"Enter"===e.key&&a.login()},a.redirectToExternalAuthProvider=function(){if("saml"===a.state.strategyType)return window.location="".concat(le.getApiPath(),"/auth/redirect/saml/").concat(a.state.strategyId);window.location=a.state.authEndpoint},a.renderForm=function(){return r.a.createElement(n.Fragment,null,r.a.createElement(Me.a,null,"Botpress Admin Panel"),r.a.createElement(De.a,null,"Login"),a.state.error&&r.a.createElement(Fe.a,{color:"danger"},a.state.error),r.a.createElement(Ue.a,null,r.a.createElement("label",{htmlFor:"email"},"E-mail"),r.a.createElement(Le.a,{value:a.state.email,onChange:a.handleInputChange,type:"text",name:"email",id:"email",onKeyPress:a.handleInputKeyPress})),r.a.createElement(Ue.a,null,r.a.createElement("label",{htmlFor:"password"},"Password"),r.a.createElement(Le.a,{value:a.state.password,onChange:a.handleInputChange,type:"password",name:"password",id:"password",onKeyPress:a.handleInputKeyPress})),r.a.createElement("p",null,r.a.createElement(Ve.a,{onClick:a.login},"Sign in")))},a}return Object(w.a)(t,e),Object(v.a)(t,[{key:"componentDidMount",value:function(){this.loadAuthConfig(),this.checkErrorMessages(),_(this.props.match.params.workspace)}},{key:"renderExternal",value:function(){return r.a.createElement(n.Fragment,null,r.a.createElement(Me.a,null,"Botpress Admin Panel"),r.a.createElement(De.a,null,"Login"),this.state.error&&r.a.createElement(Fe.a,{color:"danger"},this.state.error),r.a.createElement("p",null,r.a.createElement(Ve.a,{onClick:this.redirectToExternalAuthProvider},"Sign in with SSO")))}},{key:"render",value:function(){return this.props.auth.isAuthenticated()?r.a.createElement(m.a,{to:"/"}):this.state.isFirstTimeUse&&"basic"===this.state.strategyType?r.a.createElement(m.a,{to:"/register"}):this.state.passwordExpired?r.a.createElement(m.a,{to:{pathname:"/ChangePassword",state:this.state}}):this.state.isLoading?null:r.a.createElement("div",{className:"centered-container"},r.a.createElement("div",{className:"middle"},r.a.createElement("div",{className:"inner"},r.a.createElement("img",{className:"logo",src:Be.a,alt:"loading"}),r.a.createElement(He.a,{body:!0},r.a.createElement(Ke.a,{className:"login-box"},"saml"===this.state.strategyType?this.renderExternal():this.renderForm())))))}}]),t}(n.Component),Ye=function(e){function t(){var e,a;Object(E.a)(this,t);for(var s=arguments.length,o=new Array(s),l=0;l<s;l++)o[l]=arguments[l];return(a=Object(b.a)(this,(e=Object(y.a)(t)).call.apply(e,[this].concat(o)))).state={email:"",password:"",confirmPassword:""},a.loadAuthConfig=Object(u.a)(c.a.mark(function e(){var t;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.props.auth.getStrategyConfig(a.props.match.params.strategy);case 2:if(t=e.sent){e.next=5;break}return e.abrupt("return",a.setState({error:"Invalid strategy"}));case 5:a.setState(Object(I.a)({},t));case 6:case"end":return e.stop()}},e,this)})),a.register=Object(u.a)(c.a.mark(function e(){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a.setState({error:null}),a.state.password===a.state.confirmPassword){e.next=4;break}return a.setState({error:"Passwords don't match"}),e.abrupt("return");case 4:return e.prev=4,e.next=7,a.props.auth.register({email:a.state.email,password:a.state.password},a.state.registerUrl);case 7:e.next=12;break;case 9:e.prev=9,e.t0=e.catch(4),a.setState({error:e.t0.message});case 12:case"end":return e.stop()}},e,this,[[4,9]])})),a.handleInputChange=function(e){return a.setState(Object(je.a)({},e.target.name,e.target.value))},a.handleInputKeyPress=function(e){return"Enter"===e.key&&a.register()},a.renderForm=function(){return r.a.createElement(n.Fragment,null,r.a.createElement(Me.a,null,"Botpress Admin Panel"),r.a.createElement(De.a,null,"This is the first time you run Botpress. Please create the master admin account."),a.state.error&&r.a.createElement(Fe.a,{color:"danger"},a.state.error),r.a.createElement(Ue.a,null,r.a.createElement("label",{htmlFor:"email"},"E-mail"),r.a.createElement(Le.a,{type:"text",name:"email",id:"email",value:a.state.email,onChange:a.handleInputChange,onKeyPress:a.onInputKeyPress})),r.a.createElement(Ue.a,null,r.a.createElement("label",{htmlFor:"password"},"Password"),r.a.createElement(Le.a,{type:"password",name:"password",id:"password",value:a.state.password,onChange:a.handleInputChange,onKeyPress:a.handleInputKeyPress})),r.a.createElement(Ue.a,null,r.a.createElement("label",{htmlFor:"confirmPassword"},"Confirm password"),r.a.createElement(Le.a,{type:"password",name:"confirmPassword",id:"confirmPassword",value:a.state.confirmPassword,onChange:a.handleInputChange,onKeyPress:a.handleInputKeyPress})),r.a.createElement("p",null,r.a.createElement(Ve.a,{onClick:a.register,color:"primary",disabled:!a.isFormValid},"Create Account")))},a}return Object(w.a)(t,e),Object(v.a)(t,[{key:"componentDidMount",value:function(){this.loadAuthConfig(),_(this.props.match.params.workspace)}},{key:"render",value:function(){return this.props.auth.isAuthenticated()?r.a.createElement(m.a,{to:"/"}):r.a.createElement("div",{className:"centered-container"},r.a.createElement("div",{className:"middle"},r.a.createElement("div",{className:"inner"},r.a.createElement("img",{className:"logo",src:Be.a,alt:"loading"}),r.a.createElement(He.a,{body:!0},r.a.createElement(Ke.a,{className:"login-box"},this.renderForm())))))}},{key:"isFormValid",get:function(){var e=this.state,t=e.email,a=e.password,n=e.confirmPassword;return t.length>4&&a.length>4&&n.length>4}}]),t}(n.Component),qe=function(e){function t(e){var a;return Object(E.a)(this,t),(a=Object(b.a)(this,Object(y.a)(t).call(this,e))).login=Object(u.a)(c.a.mark(function e(){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a.setState({error:null}),a.state.newPassword===a.state.confirmPassword){e.next=4;break}return a.setState({error:"Passwords don't match"}),e.abrupt("return");case 4:return e.prev=4,e.next=7,a.props.auth.login({email:a.state.email,password:a.state.password,newPassword:a.state.newPassword},a.state.loginUrl);case 7:e.next=12;break;case 9:e.prev=9,e.t0=e.catch(4),a.setState({error:e.t0.message});case 12:case"end":return e.stop()}},e,this,[[4,9]])})),a.onInputChange=function(e){return function(t){a.setState(Object(je.a)({},e,t.target.value))}},a.onInputKeyPress=function(e){"Enter"===e.key&&a.login()},a.getReasonText=function(){return""===a.state.password?"This is the first time you run Botpress. Please pick a password.":"Your password has expired or was temporary. Please set a new password."},a.renderForm=function(){return a.state.email?r.a.createElement(n.Fragment,null,r.a.createElement(Me.a,null,"Botpress Admin Panel"),r.a.createElement(De.a,null,a.getReasonText()),a.state.error&&r.a.createElement(Fe.a,{color:"danger"},a.state.error),r.a.createElement(Ue.a,null,r.a.createElement("label",{htmlFor:"newPassword"},"Password"),r.a.createElement(Le.a,{value:a.state.newPassword,onChange:a.onInputChange("newPassword"),type:"password",name:"newPassword",id:"newPassword",onKeyPress:a.onInputKeyPress})),r.a.createElement(Ue.a,null,r.a.createElement("label",{htmlFor:"confirmPassword"},"Confirm password"),r.a.createElement(Le.a,{value:a.state.confirmPassword,onChange:a.onInputChange("confirmPassword"),type:"password",name:"confirmPassword",id:"confirmPassword",onKeyPress:a.onInputKeyPress})),r.a.createElement("p",null,r.a.createElement(Ve.a,{onClick:a.login},"Change"))):r.a.createElement(m.a,{to:"/"})},a.state=Object(I.a)({},e.location.state,{newPassword:"",confirmPassword:""}),a}return Object(w.a)(t,e),Object(v.a)(t,[{key:"render",value:function(){return this.props.auth.isAuthenticated()?r.a.createElement(m.a,{to:{pathname:"/"}}):r.a.createElement("div",{className:"centered-container"},r.a.createElement("div",{className:"middle"},r.a.createElement("div",{className:"inner"},r.a.createElement("img",{className:"logo",src:Be.a,alt:"loading"}),r.a.createElement(He.a,{body:!0},r.a.createElement(Ke.a,{className:"login-box"},this.renderForm())))))}}]),t}(n.Component),Ze=function(e){var t=e.component,a=e.auth,n=e.children,s=Object(Pe.a)(e,["component","auth","children"]);return r.a.createElement(h.a,Object.assign({},s,{render:function(e){return a.isAuthenticated()?r.a.createElement(t,Object.assign({},e,{auth:a}),n):r.a.createElement(m.a,{to:{pathname:"/login",state:{from:e.location}}})}}))},Je=a(66),_e=a(412),Qe={pendingChanges:{},loading:!1},We={bots:null,loadingBots:!1,botTemplates:[],botTemplatesFetched:!1,botCategories:[],botCategoriesFetched:!1},Ge=function(){return function(){var e=Object(u.a)(c.a.mark(function e(t){var a,n;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,le.getSecured().get("/admin/bots/categories");case 2:a=e.sent,n=a.data,t({type:"bots/RECEIVED_BOT_CATEGORIES",categories:n.payload.categories});case 5:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},Xe=function(){return function(){var e=Object(u.a)(c.a.mark(function e(t){var a,n;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t({type:"bots/FETCH_BOTS_REQUESTED"}),e.next=3,le.getSecured().get("/admin/bots");case 3:a=e.sent,n=a.data,t({type:"bots/FETCH_BOTS_RECEIVED",bots:n.payload.bots,workspace:n.payload.workspace});case 6:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},$e={roles:[],loading:!1},et=function(){return function(){var e=Object(u.a)(c.a.mark(function e(t,a){var n,r,s;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=a(),!n.roles.loading){e.next=3;break}return e.abrupt("return");case 3:return t({type:"roles/FETCH_ROLES_REQUESTED"}),e.next=6,le.getSecured().get("/admin/roles");case 6:r=e.sent,s=r.data,t({type:"roles/FETCH_ROLES_RECEIVED",roles:s.payload.roles});case 9:case"end":return e.stop()}},e,this)}));return function(t,a){return e.apply(this,arguments)}}()},tt=a(40),at=a.n(tt),nt={stats:null,lastDate:null,loading:!0,loadingIncidents:!0},rt={modules:[]},st={languages:null},ot=Object(Je.c)({routing:g.d,versioning:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Qe,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"versioning/FETCH_PENDING_CHANGES":return Object(I.a)({},e,{loading:!0});case"versioning/RECEIVE_PENDING_CHANGES":return{loading:!1,pendingChanges:t.pendingChanges};default:return e}},license:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ie,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"license/LICENSE_KEY_UPDATED":var a=e.keys.findIndex(function(e){return e.stripeSubscriptionId===t.license.stripeSubscriptionId});return Object(I.a)({},e,{keys:Object(x.a)(e.keys.slice(0,a)).concat([t.license],Object(x.a)(e.keys.slice(a+1)))});case"license/LOGOUT_USER_FROM_LICENSE_SERVER":return Object(I.a)({},ie);case"license/FETCH_LICENSING_RECEIVED":return Object(I.a)({},e,{licensing:t.licensing});case"license/FETCH_KEYS_REQUESTED":return Object(I.a)({},e,{fetchingKeys:!0});case"license/FETCH_KEYS_RECEIVED":return Object(I.a)({},e,{keys:t.keys,fetchingKeys:!1});case"license/UPDATE_LICENSING_ACCOUNT":return Object(I.a)({},e,{licensingAccount:t.account});case"license/FETCH_PRODUCTS_REQUESTED":return Object(I.a)({},e,{fetchingProducts:!0});case"license/FETCH_PRODUCTS_RECEIVED":return Object(I.a)({},e,{products:t.products,fetchingProducts:!1});default:return e}},bots:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:We,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"bots/RECEIVED_BOT_CATEGORIES":return Object(I.a)({},e,{botCategories:t.categories||[],botCategoriesFetched:!0});case"bots/RECEIVED_BOT_TEMPLATES":return Object(I.a)({},e,{botTemplates:t.templates||[],botTemplatesFetched:!0});case"bots/FETCH_BOTS_REQUESTED":return Object(I.a)({},e,{loadingBots:!0});case"bots/FETCH_BOTS_RECEIVED":return Object(I.a)({},e,{loadingBots:!1,bots:t.bots,workspace:t.workspace});default:return e}},user:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ve,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"user/MY_PROFILE_REQUESTED":case"user/MY_PERMISSIONS_REQUESTED":return Object(I.a)({},e,{loading:!0});case"user/FETCH_USERS_REQUESTED":return Object(I.a)({},e,{loadingUsers:!0});case"user/MY_PROFILE_RECEIVED":return Object(I.a)({},e,{loading:!1,profile:t.profile});case"user/MY_PERMISSIONS_RECEIVED":return Object(I.a)({},e,{loading:!1,permissions:t.permissions});case"user/FETCH_USERS_RECEIVED":return Object(I.a)({},e,{loadingUsers:!1,items:t.users});default:return e}},roles:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:$e,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"roles/FETCH_ROLES_REQUESTED":return Object(I.a)({},e,{loading:!0});case"roles/FETCH_ROLES_RECEIVED":return Object(I.a)({},e,{loading:!1,roles:t.roles});default:return e}},monitoring:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:nt,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"monitoring/FETCH_STATS_FULL_RECEIVED":return Object(I.a)({},e,{stats:t.stats,lastDate:t.toTime,loading:!1});case"bots/FETCH_STATS_PARTIAL_RECEIVED":return Object(I.a)({},e,{stats:Object(x.a)(e.stats).concat(Object(x.a)(t.stats)),lastDate:t.toTime});case"monitoring/FETCH_STATS_FULL_REQUESTED":return Object(I.a)({},e,{loading:!0});case"bots/FETCH_INCIDENTS_RECEIVED":return Object(I.a)({},e,{incidents:t.data,loadingIncidents:!1});case"bots/FETCH_INCIDENTS_REQUESTED":return Object(I.a)({},e,{loadingIncidents:!0});default:return e}},modules:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:rt,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"bots/FETCH_MODULES_RECEIVED":return Object(I.a)({},e,{modules:t.modules});default:return e}},server:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:st,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"server/FETCH_LANGUAGES_RECEIVED":return Object(I.a)({},e,{languages:t.languages});default:return e}}}),lt=[_e.a,Object(g.c)(H)],it=Je.d.apply(void 0,[Je.a.apply(void 0,lt)].concat([])),ct=Object(Je.e)(ot,{},it),ut=a(899),dt=a(900),mt=a(901),pt=a(902),ht=a(3),ft=a.n(ht),gt=a(20),Et=a(413),vt=function(e){return e.operation&&e.resource&&!Object(Et.checkRule)(e.permissions,e.operation,e.resource)?null:e.children},bt=a(898),yt=function(e){function t(){var e,a;Object(E.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(b.a)(this,(e=Object(y.a)(t)).call.apply(e,[this].concat(r)))).state={activeTab:null},a.updateRoute=function(e){return a.props.history.push(e)},a.matchCurrentPath=function(e){return Object(bt.a)(a.props.location.pathname,{path:e})},a.getCurrentTab=function(){return a.props.tabs.find(function(e){return a.matchCurrentPath(e.route)})},a}return Object(w.a)(t,e),Object(v.a)(t,[{key:"componentDidMount",value:function(){!this.props.permissions&&this.props.fetchPermissions(),!this.props.licensing&&this.props.fetchLicensing(),this.setState({activeTab:this.props.tabs[0].name})}},{key:"renderHomeTab",value:function(){var e=this;return r.a.createElement(ut.a,{className:"bringMeHome",onClick:function(){return e.props.history.push("/admin")}},r.a.createElement(gt.j,null),r.a.createElement(gt.g,null))}},{key:"renderNavItem",value:function(e){var t=this;return!this.props.licensing||e.proOnly&&!this.props.licensing.isPro?null:r.a.createElement(vt,{permissions:this.props.permissions,resource:e.res,operation:e.op,key:e.name},r.a.createElement(ut.a,null,r.a.createElement(A.a,{className:this.matchCurrentPath(e.route)&&"active",onClick:function(){return t.updateRoute(e.route)}},e.icon,e.name)))}},{key:"render",value:function(){var e=this,t=this.getCurrentTab(),a=t&&t.useFullWidth,s=t&&t.size||10,o=t&&t.offset||1;return r.a.createElement(n.Fragment,null,r.a.createElement("div",{className:"bp_container-header"},r.a.createElement(dt.a,null,r.a.createElement(mt.a,null,r.a.createElement(pt.a,{xs:12,md:{size:10,offset:1}},r.a.createElement("h2",{className:"bp-main-content__title"},this.props.title))),r.a.createElement(mt.a,null,r.a.createElement(pt.a,{xs:12,md:{size:10,offset:1}},r.a.createElement(S.a,{tabs:!0,className:"bp_container-tabs"},this.props.showHome&&this.renderHomeTab(),this.props.tabs.map(function(t){return e.renderNavItem(t)})))))),r.a.createElement("div",{className:ft()({"bp_container-fullwidth":a})},r.a.createElement(dt.a,null,r.a.createElement(mt.a,null,r.a.createElement(pt.a,{xs:12,md:{size:s,offset:o}},r.a.createElement(p.a,null,this.props.tabs.map(function(e){return r.a.createElement(h.a,{path:e.route,exact:!0,component:e.component,key:e.name})})))))))}}]),t}(n.Component),wt={fetchPermissions:we,fetchLicensing:ce},kt=Object(f.b)(function(e){return{permissions:e.user.permissions,licensing:e.license.licensing}},wt)(yt),Ot=a(406),Ct={0:[255,0,0],.25:[255,128,0],.5:[255,195,0],.75:[255,255,0],1:[144,238,144]},Rt=function(e){return 1==e.length?"0"+e:e},St=M.a.curry(M.a.multiply),At=function(e){return"#".concat(e.map(function(e){return e.toString(16)}).map(Rt).join(""))};function xt(e){var t=Math.max(0,.25*Math.floor(e/.25)),a=Math.min(1,.25*Math.ceil(e/.25)),n=Math.max(0,Math.min(1,(a-e)/.25));return function(e,t,a){var n=((2*a-1)/1+1)/2,r=1-n,s=M.a.zipWith(e.map(St(n)),t.map(St(r)),function(e,t){return Math.round(e+t)});return At(s)}(Ct[t],Ct[a],n)}a(640);var It=function(e){var t=e.scoreInPercent,a=e.scoreInAbsolute,r="none",s={};return a&&(t=1-(Math.min(.9,a/6)+.1)),"number"===typeof t&&(r=null,s={backgroundColor:xt(t)}),n.createElement("td",{className:e.className},n.createElement("span",{style:s,className:r&&"color-".concat(r)},e.children))},Nt=function(e){var t=e.matrix;delete(t=Object(I.a)({},t)).all;var a=M.a.chain(t).keys().filter(function(e){return"none"!==e}).orderBy(function(e){return t[e].f1},"asc").value(),r=M.a.mapValues(t,function(e,t){return a.indexOf(t)}),s=Object.keys(r).length,o=M.a.map(a,function(e){var a=t[e];if("none"===e)return null;var o=new Array(s).fill(n.createElement(It,{className:"no-confusion"},"0"),0,r[e]);o[r[e]+1]=n.createElement("td",{className:"name"},n.createElement("span",null,e));var l=a.confusions.none||0,i=n.createElement("div",{className:"smallTooltip"},n.createElement("div",null,n.createElement("label",null,"F1: "),n.createElement("strong",null,a.f1.toFixed(2))),n.createElement("div",null,n.createElement("label",null,"Precision: "),n.createElement("strong",null,a.precision.toFixed(2))),n.createElement("div",null,n.createElement("label",null,"Recall: "),n.createElement("strong",null,a.recall.toFixed(2))),n.createElement("br",null),n.createElement("div",null,n.createElement("label",null,"False Positives:"),n.createElement("strong",null,a.fp)),n.createElement("div",null,n.createElement("label",null,"False Negatives:"),n.createElement("strong",null,a.fn-l)),l&&n.createElement("div",null,n.createElement("label",null,"Not found (none):"),n.createElement("strong",null,l)));o[r[e]]=n.createElement(It,{className:"identity",scoreInPercent:a.f1||0},n.createElement(Ot.a,{content:i,position:pe.a.TOP},n.createElement("a",{"data-tip":!0,"data-for":"cls-"+e},a.f1.toFixed(1))));var c=!0,u=!1,d=void 0;try{for(var m,p=Object.keys(a.confusions||[]).filter(function(e){return"none"!==e})[Symbol.iterator]();!(c=(m=p.next()).done);c=!0){var h=m.value;if(!(r[h]>r[e])){var f="cls-".concat(e,"--vs--").concat(h),g=(a.confusions||[])[h]+((t[h].confusions||{})[e]||0),E=n.createElement("div",{className:"smallTooltip"},"The model got confused ",n.createElement("strong",null,g)," times with the ",n.createElement("strong",null,h)," intent.");o[r[h]]=n.createElement(It,{scoreInAbsolute:g},n.createElement(Ot.a,{content:E,position:pe.a.TOP},n.createElement("a",{"data-tip":!0,"data-for":f},g)))}}}catch(v){u=!0,d=v}finally{try{c||null==p.return||p.return()}finally{if(u)throw d}}return n.createElement("tr",null,o)});return n.createElement("div",null,n.createElement("div",null,n.createElement("table",{className:"matrix"},o)))},jt=function(e){return n.createElement("div",null,n.createElement("div",{className:"App"},M.a.map(e,function(e,t){return n.createElement(Nt,{matrix:e,name:t})})))},Pt=a(903),Tt=a(904),Bt=a(905),Mt=a(62),Dt=["lang","version"],Ft=function(e){function t(){var e,a;Object(E.a)(this,t);for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return(a=Object(b.a)(this,(e=Object(y.a)(t)).call.apply(e,[this].concat(s)))).state={confusions:[],botIds:[],select:["",""],isComputing:!1,version:""},a.componentDidMount=Object(u.a)(c.a.mark(function e(){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:a.loadBots();case 1:case"end":return e.stop()}},e,this)})),a.versionChange=function(e){return a.setState({version:e.target.value})},a.setSelect=function(e,t){return a.setState({select:Object(x.a)(a.state.select.slice(0,t)).concat([e],Object(x.a)(a.state.select.slice(t+1)))})},a.selectChangeFromFrontEnd=function(e){return function(t){return a.setSelect(t.target.value,e)}},a.fetchConfusionForBot=function(){var e=Object(u.a)(c.a.mark(function e(t){var a,n;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,le.getSecured().get("/bots/".concat(t,"/mod/nlu/confusion"));case 3:return a=e.sent,n=a.data,e.abrupt("return",n);case 8:e.prev=8,e.t0=e.catch(0),console.error("Could not fetch confusion for bot ".concat(t),e.t0);case 11:case"end":return e.stop()}},e,this,[[0,8]])}));return function(t){return e.apply(this,arguments)}}(),a.handleVersionChanged=function(e){a.setState({version:e.target.value}),a.setSelect(e.target.value,1)},a.triggerComputeConfusionForBot=function(){var e=Object(u.a)(c.a.mark(function e(t){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,le.getSecured({timeout:999999999}).post("/bots/".concat(t,"/mod/nlu/confusion"),{version:a.state.version});case 2:return e.abrupt("return",e.sent.data);case 3:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),a.getAllConfusions=Object(u.a)(c.a.mark(function e(){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=Promise,e.t1=a.state.botIds,e.next=4,a.fetchConfusionForBot;case 4:return e.t2=e.sent,e.t3=e.t1.map.call(e.t1,e.t2),e.next=8,e.t0.all.call(e.t0,e.t3);case 8:return e.abrupt("return",e.sent);case 9:case"end":return e.stop()}},e,this)})),a.triggerCompute=Object(u.a)(c.a.mark(function e(){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a.setState({isComputing:!0}),e.t0=Promise,e.t1=a.state.botIds,e.next=5,a.triggerComputeConfusionForBot;case 5:return e.t2=e.sent,e.t3=e.t1.map.call(e.t1,e.t2),e.next=9,e.t0.all.call(e.t0,e.t3);case 9:return e.t4=a,e.next=12,a.getAllConfusions();case 12:e.t5=e.sent,e.t4.addConfusionToState.call(e.t4,e.t5),a.initLabels(),a.setState({isComputing:!1,select:[a.state.select[0],a.state.version]});case 16:case"end":return e.stop()}},e,this)})),a.addConfusionToState=function(e){return a.setState({confusions:e})},a.initLabels=function(){return a.getAttributesFromAllConfusions(Dt).map(function(e){return e[0]}).forEach(a.setSelect)},a.getValueForAttributes=function(e){return function(t){return Object.values(M.a.pick(t,e))}},a.getAttributesFromAllConfusions=function(e){return M.a.chain(a.state.confusions||[]).map(function(t){return t.confusions.map(a.getValueForAttributes(e))}).flatten().unzip().map(M.a.uniq).value()},a.langSelectValues=function(){return a.getAttributesFromAllConfusions(["lang"])[0]||[]},a.versionSelectValues=function(){return a.getAttributesFromAllConfusions(["version"])[0]||[]},a.renderConfusions=function(){return r.a.createElement("div",{style:{padding:10}},a.renderToolbar(),(a.state.confusions||[]).map(function(e){return r.a.createElement("div",{key:"conf-".concat(e.botId)},r.a.createElement("h3",null,e.botId),e.confusions.filter(function(e){return M.a.get(e,"matrix.intents.all.f1")}).filter(function(e){return M.a.isEmpty(M.a.difference(a.getValueForAttributes(Dt)(e),a.state.select))}).map(function(e,t){return r.a.createElement("div",{key:e.hash+t},r.a.createElement("h6",null,"[",e.lang.toUpperCase(),"] - F1: ",r.a.createElement("strong",null,e.matrix.intents.all.f1.toFixed(2))),r.a.createElement(jt,{data:e.matrix.intents}))}))}))},a}return Object(w.a)(t,e),Object(v.a)(t,[{key:"componentDidUpdate",value:function(e,t){e.bots!==this.props.bots&&this.loadBots()}},{key:"loadBots",value:function(){var e=Object(u.a)(c.a.mark(function e(){var t,a=this;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.props.bots){e.next=2;break}return e.abrupt("return",this.props.fetchBots());case 2:t=this.props.bots.filter(function(e){return!e.disabled}).map(function(e){return e.id}),this.setState({botIds:t},Object(u.a)(c.a.mark(function e(){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=a,e.next=3,a.getAllConfusions();case 3:e.t1=e.sent,e.t0.addConfusionToState.call(e.t0,e.t1),a.initLabels();case 6:case"end":return e.stop()}},e,this)})));case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"renderToolbar",value:function(){return r.a.createElement("div",{style:{display:"flex"}},r.a.createElement("div",null,r.a.createElement("h5",null,"View existing Confusion"),r.a.createElement("div",{style:{display:"flex"}},r.a.createElement(Pt.a,{label:"Language",style:{width:120}},r.a.createElement("select",{key:"select-lang",value:this.state.select[0],onChange:this.selectChangeFromFrontEnd(0)},this.langSelectValues().map(function(e){return r.a.createElement("option",{key:e,value:e},e)}))),r.a.createElement(Pt.a,{label:"Version",style:{width:150}},r.a.createElement("select",{key:"select-version",value:this.state.select[1],onChange:this.handleVersionChanged},this.versionSelectValues().map(function(e){return r.a.createElement("option",{key:e,value:e},e)}))))),r.a.createElement("div",null,r.a.createElement("h5",null,"Recompute Confusion"),r.a.createElement("div",{style:{display:"flex"}},this.state.isComputing?r.a.createElement("span",null,"Please wait, computing confusion... (version: ",this.state.version,")"):r.a.createElement(Pt.a,{label:"Assign results to version..."},r.a.createElement(Tt.a,null,r.a.createElement(Bt.a,{placeholder:"Version (optional)",value:this.state.version,onChange:this.versionChange}),r.a.createElement(he.b,{onClick:this.triggerCompute,text:"Go"}))))))}},{key:"render",value:function(){var e=[{name:"Confusions",route:"/confusion",icon:r.a.createElement(Mt.a,{icon:"cube"}),component:this.renderConfusions,useFullWidth:!0}];return r.a.createElement(kt,Object.assign({title:"Confusion Matrix"},Object(I.a)({tabs:e},this.props,{showHome:!0})))}}]),t}(n.Component),Ut={fetchBots:Xe},Lt=Object(f.b)(function(e){return{bots:e.bots.bots}},Ut)(Ft),Vt=a(80),Ht=a(906),Kt=a(907),zt=a(51),Yt=a(921),qt=function(e){var t=e.helpText,a=e.activePage,n=e.title,s=e.mainContent,o=e.sideMenu;return r.a.createElement("div",{className:"bp-main-content-main"},r.a.createElement(mt.a,null,r.a.createElement(pt.a,{xs:12,md:10},r.a.createElement("h2",{className:"bp-main-content__title"},n,t&&r.a.createElement("span",null,r.a.createElement(gt.h,{id:"help".concat(a),className:"section-title-help"}),r.a.createElement(Yt.a,{placement:"right",target:"help".concat(a)},t))))),r.a.createElement(mt.a,null,r.a.createElement(pt.a,{xs:o?10:12},s),o&&r.a.createElement(pt.a,{xs:2},o)))},Zt=a(182),Jt=(a(327),function(e){var t=e.data,a=[{Header:"Rule",accessor:"ruleName"},{Header:"Host",accessor:"hostName"},{Header:"Start Time",Cell:function(e){return at()(e.value).format("YYYY-MM-DD HH:mm:ss")},width:140,className:"center",accessor:"startTime"},{Header:"End Time",Cell:function(e){return e.value&&at()(e.value).format("YYYY-MM-DD HH:mm:ss")||""},width:140,accessor:"endTime"},{Header:"Trigger Value",width:100,accessor:"triggerValue"}];return r.a.createElement(Zt.a,{columns:a,data:t,defaultPageSize:5,defaultSorted:[{id:"host"}],className:"-striped -highlight monitoringOverview"})}),_t=a(414),Qt=a.n(_t),Wt=function(){return r.a.createElement(mt.a,null,r.a.createElement(pt.a,{className:"section",xs:12},r.a.createElement("div",{className:"middle"},r.a.createElement("img",{src:Qt.a,alt:"loading"}))))},Gt=[{value:"1h",label:"1 hour"},{value:"2h",label:"2 hours"},{value:"5h",label:"5 hours"},{value:"15h",label:"15 hours"},{value:"24h",label:"24 hours"}],Xt=function(e){function t(){var e,a;Object(E.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(b.a)(this,(e=Object(y.a)(t)).call.apply(e,[this].concat(r)))).state={intervalId:null,timeFrame:null,timeFrameOptions:Gt},a.handleTimeFrameChanged=function(e){return a.setState({timeFrame:e},a.queryData)},a.handleAutoRefreshChanged=function(e){var t=e.target.checked,n=void 0;t&&!a.state.intervalId?n=setInterval(function(){return a.queryData()},1e4):!t&&a.state.intervalId&&clearInterval(a.state.intervalId),a.setState({autoRefresh:t,intervalId:n})},a}return Object(w.a)(t,e),Object(v.a)(t,[{key:"componentDidMount",value:function(){this.setState({timeFrame:Gt[0]},this.queryData)}},{key:"componentWillUnmount",value:function(){this.state.intervalId&&clearInterval(this.state.intervalId)}},{key:"queryData",value:function(){var e=Object(u.a)(c.a.mark(function e(){var t,a;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.state.timeFrame){e.next=2;break}return e.abrupt("return");case 2:try{t=at()().subtract(z()(this.state.timeFrame.value)).toDate().getTime(),a=at()().toDate().getTime(),this.props.fetchIncidents(t,a)}catch(n){this.setState({error:n.message})}case 3:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"renderTables",value:function(){return this.props.incidents?r.a.createElement("div",null,r.a.createElement("h4",null,"Active Incidents"),r.a.createElement(Jt,{data:this.props.incidents.active}),r.a.createElement("h4",null,"Resolved Incidents"),r.a.createElement(Jt,{data:this.props.incidents.resolved})):null}},{key:"renderNoData",value:function(){return r.a.createElement(Ht.a,null,r.a.createElement(mt.a,null,r.a.createElement(pt.a,{style:{textAlign:"center"},sm:"12",md:{size:8,offset:2}},r.a.createElement("h1",null,r.a.createElement(Vt.a,null),"\xa0 Alerting is not enabled or there is no statistics."),r.a.createElement("p",null,"Make sure that alerting is enabled in your Botpress Config."))))}},{key:"render",value:function(){return this.props.incidents?this.props.loadingIncidents?r.a.createElement(Wt,null):r.a.createElement(qt,{title:null,helpText:null,mainContent:this.renderTables(),sideMenu:this.renderSideMenu()}):this.renderNoData()}},{key:"renderSideMenu",value:function(){var e={control:function(e){return Object(I.a)({},e,{minHeight:30})},dropdownIndicator:function(e){return Object(I.a)({},e,{padding:4})},clearIndicator:function(e){return Object(I.a)({},e,{padding:4})},valueContainer:function(e){return Object(I.a)({},e,{padding:"0px 6px"})},input:function(e){return Object(I.a)({},e,{margin:0,padding:0})}};return r.a.createElement("div",{style:{fontSize:"80%"}},r.a.createElement("strong",null,"Time Frame"),r.a.createElement(zt.a,{styles:e,options:Gt,value:this.state.timeFrame,onChange:this.handleTimeFrameChanged,isSearchable:!1}),r.a.createElement("strong",null,"Auto-Refresh"),r.a.createElement("br",null),r.a.createElement(Kt.a,null,r.a.createElement("input",{style:{marginTop:8},name:"autoRefresh",type:"checkbox",value:this.state.autoRefresh,onChange:this.handleAutoRefreshChanged})," ",r.a.createElement("strong",null,"Enabled")))}}]),t}(n.Component),$t={fetchIncidents:function(e,t){return function(){var a=Object(u.a)(c.a.mark(function a(n){var r,s;return c.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return n({type:"bots/FETCH_INCIDENTS_REQUESTED"}),a.next=3,le.getSecured().post("/admin/server/incidents",{fromTime:e,toTime:t});case 3:r=a.sent,s=r.data,n({type:"bots/FETCH_INCIDENTS_RECEIVED",data:s});case 6:case"end":return a.stop()}},a,this)}));return function(e){return a.apply(this,arguments)}}()}},ea=Object(f.b)(function(e){return{incidents:e.monitoring.incidents}},$t)(Xt),ta=a(67),aa=a(908),na=a(416),ra=a.n(na),sa=(a(642),a(50)),oa=a(926).a.create({className:"recipe-toaster",position:pe.a.TOP}),la=function(e){function t(){var e,a;Object(E.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(b.a)(this,(e=Object(y.a)(t)).call.apply(e,[this].concat(r)))).state={nodes:void 0,checked:[],expanded:["bp"],persist:!1},a.loadConfiguration=Object(u.a)(c.a.mark(function e(){var t,n,r,s,o,l,i,u,d;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,le.getSecured().get("/admin/server/debug");case 2:for(t=e.sent,n=t.data,r={label:"bp",children:[],expandDisabled:!0},s=!0,o=!1,l=void 0,e.prev=8,i=Object.keys(n).sort()[Symbol.iterator]();!(s=(u=i.next()).done);s=!0)d=u.value,a.buildNodeRecursive(r,d.split(":"),0);e.next=16;break;case 12:e.prev=12,e.t0=e.catch(8),o=!0,l=e.t0;case 16:e.prev=16,e.prev=17,s||null==i.return||i.return();case 19:if(e.prev=19,!o){e.next=22;break}throw l;case 22:return e.finish(19);case 23:return e.finish(16);case 24:a.setState({nodes:r.children,checked:Object.keys(n).filter(function(e){return n[e]})});case 25:case"end":return e.stop()}},e,this,[[8,12,16,24],[17,,19,23]])})),a.saveConfiguration=Object(u.a)(c.a.mark(function e(){var t;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.state.checked&&a.state.checked.join(","),e.next=3,le.getSecured().post("/admin/server/debug",{debugScope:t,persist:a.state.persist});case 3:oa.show({message:"Debug configuration updated successfully!",intent:ta.a.SUCCESS,timeout:2e3});case 4:case"end":return e.stop()}},e,this)})),a.handlePersistChanged=function(e){return a.setState({persist:e.target.checked})},a}return Object(w.a)(t,e),Object(v.a)(t,[{key:"componentDidMount",value:function(){var e=Object(u.a)(c.a.mark(function e(){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.loadConfiguration();case 2:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"buildNodeRecursive",value:function(e,t,a){if(a<t.length){var n=t[a],r=e.children.find(function(e){return e.label===n});r||(r={label:n,value:t.slice(0,a+1).join(":"),children:[]},e.children.push(r)),this.buildNodeRecursive(r,t,a+1)}}},{key:"renderTree",value:function(){var e=this;return this.state.nodes?r.a.createElement(ra.a,{nodes:this.state.nodes||[],checked:this.state.checked,expanded:this.state.expanded,onCheck:function(t){return e.setState({checked:t})},onExpand:function(t){return e.setState({expanded:["bp"].concat(Object(x.a)(t))})},showExpandAll:!0,icons:{check:r.a.createElement(sa.a,null),uncheck:r.a.createElement(sa.l,null),halfCheck:r.a.createElement(sa.a,{fillOpacity:"0.5"}),expandClose:r.a.createElement(sa.c,null),expandOpen:r.a.createElement(sa.b,null),expandAll:r.a.createElement(sa.j,null),collapseAll:r.a.createElement(sa.h,null),parentClose:r.a.createElement(sa.f,{stroke:"blue",fill:"none"}),parentOpen:r.a.createElement(sa.g,{stroke:"blue",fill:"none"}),leaf:r.a.createElement(sa.e,{stroke:"blue",fill:"none"})}}):null}},{key:"renderSide",value:function(){return r.a.createElement("div",null,r.a.createElement(he.b,{onClick:this.loadConfiguration,fill:!0,icon:"refresh",text:"Refresh"}),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement(Ot.a,{content:"When checked, the selected debug options will be enabled after each server restart"},r.a.createElement(aa.a,{checked:this.state.persist,onChange:this.handlePersistChanged,label:"Persist"})),r.a.createElement(he.b,{onClick:this.saveConfiguration,intent:ta.a.PRIMARY,fill:!0,icon:"floppy-disk",text:"Save"}))}},{key:"render",value:function(){return r.a.createElement(qt,{title:"Configure Debug",helpText:"This page allows you to enable or disable some debug scopes while using Botpress. This list is populated while features are being used, so some items may be missing",activePage:"bots",mainContent:this.renderTree(),sideMenu:this.renderSide()})}}]),t}(r.a.Component),ia=a(910),ca=a(407),ua=a(909),da=["bytes","Kb","Mb","Gb","Tb"];function ma(e){var t=Math.log2(e),a=Math.min(Math.floor(t/10),4),n=e/Math.pow(2,10*a);return"".concat(n.toFixed(0)," ").concat(da[a])}var pa=function(e){var t=e.current/e.total,a="".concat(ma(e.current)," / ").concat(ma(e.total));return r.a.createElement(Ot.a,{content:a,position:pe.a.TOP},r.a.createElement("div",{style:{width:"250px"}},r.a.createElement(ua.a,{value:t})))},ha=function(e){var t=Object(n.useState)(!1),a=Object(d.a)(t,2),s=a[0],o=a[1],l=function(){var t=Object(u.a)(c.a.mark(function t(){return c.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,le.getSecured().delete("/admin/languages/".concat(e.language.code));case 2:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),i=function(){var t=Object(u.a)(c.a.mark(function t(){return c.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,le.getSecured().post("/admin/languages/".concat(e.language.code));case 2:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),m=function(){var t=Object(u.a)(c.a.mark(function t(){return c.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return o(!0),t.prev=1,t.next=4,le.getSecured().post("/admin/languages/".concat(e.language.code,"/load"));case 4:t.next=9;break;case 6:t.prev=6,t.t0=t.catch(1),console.log("error loading model");case 9:return t.prev=9,o(!1),t.finish(9);case 12:case"end":return t.stop()}},t,this,[[1,6,9,12]])}));return function(){return t.apply(this,arguments)}}();return r.a.createElement("div",{className:"language"},r.a.createElement("div",null,r.a.createElement("div",{className:"flag"},r.a.createElement("img",{src:e.language.flag,alt:e.language.code})),r.a.createElement("span",null,e.language.name)),r.a.createElement("div",{className:"action"},e.downloadProgress&&r.a.createElement(pa,{current:e.downloadProgress.progress.size,total:e.language.size}),e.allowActions&&!e.downloadProgress&&!e.installed&&r.a.createElement(he.b,{small:!0,onClick:i,minimal:!0,icon:"import"}),e.allowActions&&e.installed&&!e.loaded&&r.a.createElement(he.b,{disabled:s,minimal:!0,icon:"updated",onClick:m},s?"loading":"Load"),e.allowActions&&e.installed&&r.a.createElement(he.b,{disabled:s,icon:"cross",minimal:!0,onClick:l})))},fa=function(){var e=Object(u.a)(c.a.mark(function e(t){var a,n;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,le.getSecured().get("/admin/languages");case 2:a=e.sent,n=a.data,t(n);case 5:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),ga=function(e){var t=Object(n.useState)(),a=Object(d.a)(t,2),s=a[0],o=a[1];if(Object(n.useEffect)(function(){!function(){var e=Object(u.a)(c.a.mark(function e(){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fa(o);case 2:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()()},[]),Object(n.useEffect)(function(){var e=setInterval(fa.bind({},o),2e3);return function(){return clearInterval(e)}}),!s)return r.a.createElement(ca.a,{size:30});var l=(s.available||[]).filter(function(e){return!s.installed.find(function(t){return t.lang===e.code})}),i=s.installed.map(function(e){return Object(I.a)({},e,s.available.find(function(t){return t.code===e.lang}))});return r.a.createElement(r.a.Fragment,null,s&&s.available.length>0&&!e.readOnly&&!!l.length&&r.a.createElement("div",{className:"languages-list"},r.a.createElement("h4",null,"Add Languages"),l.map(function(t){return r.a.createElement(ha,{key:t.code,language:t,installed:!1,loaded:!1,allowActions:!e.readOnly,languageSource:e.languageSource,downloadProgress:s.downloading.find(function(e){return e.lang==t.code})})})),r.a.createElement("div",{className:"languages-list"},r.a.createElement("h4",null,"Installed Languages"),0===i.length&&r.a.createElement("p",null,"No languages yet"),i.map(function(t){return r.a.createElement(ha,{key:t.code,language:t,installed:!0,loaded:t.loaded,allowActions:!e.readOnly,languageSource:e.languageSource})})))},Ea=function(e){return r.a.createElement("div",null,r.a.createElement("p",{style:{textAlign:"center"}},"Using lang server at ",r.a.createElement("br",null),e.source.endpoint),r.a.createElement("p",{style:{marginTop:50,width:240,textAlign:"center"}},r.a.createElement("small",null,"To run your own language server, follow the instructions"," ",r.a.createElement("a",{href:"https://botpress.io/docs/advanced/hosting#running-your-own-language-server",target:"_blank"},"in the documentation"))))},va=function(){var e=Object(u.a)(c.a.mark(function e(t){var a,n,r;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,le.getSecured().get("/admin/languages/sources");case 2:return a=e.sent,n=a.data,r=n.languageSources[0],t(r),e.abrupt("return",r);case 7:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),ba=function(){var e=Object(u.a)(c.a.mark(function e(t,a){var n,r;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,le.getSecured().get("/admin/languages/info");case 2:n=e.sent,r=n.data,a(r);case 5:case"end":return e.stop()}},e,this)}));return function(t,a){return e.apply(this,arguments)}}(),ya=function(){var e=Object(n.useState)(),t=Object(d.a)(e,2),a=t[0],s=t[1],o=Object(n.useState)(),l=Object(d.a)(o,2),i=l[0],m=l[1];return Object(n.useEffect)(function(){(function(){var e=Object(u.a)(c.a.mark(function e(){var t;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,va(s);case 2:return t=e.sent,e.next=5,ba(t,m);case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}})()()},[]),a&&i?r.a.createElement("div",{className:"languages-grid"},r.a.createElement("div",null,i.readOnly&&r.a.createElement(ia.a,{intent:"warning"},"Languages cannot be edited as Language Server is read only"),r.a.createElement(ga,{languageSource:a,readOnly:i.readOnly})),r.a.createElement(Ea,{source:a,langServer:i})):r.a.createElement("div",null,"loading...")},wa=a(125),ka=a.n(wa),Oa=function(e){function t(e){var a;return Object(E.a)(this,t),(a=Object(b.a)(this,Object(y.a)(t).call(this,e))).displayPolicies=function(){var e=a.props.license,t=e.seats,n=e.versions,r=e.startDate,s=e.endDate;a.setState({policies:[]}),a.addPolicy("Admins",t,a.getBreach("studio seats")),a.addPolicy("Nodes","",a.getBreach("nodes")),a.addPolicy("Version",n,a.getBreach("version")),a.addPolicy("Start Date",at()(r).format("YYYY-MM-DD"),a.getBreach("date")),a.addPolicy("End Date",at()(s).format("YYYY-MM-DD"),a.getBreach("date")),a.addPolicy("Server Fingerprint","",a.getBreach("fingerprint"))},a.addPolicy=function(e,t,n){a.setState(function(a){return{policies:Object(x.a)(a.policies).concat([{name:e,status:t,breachError:n}])}})},a.state={policies:[],breachs:[]},a}return Object(w.a)(t,e),Object(v.a)(t,[{key:"componentDidMount",value:function(){this.displayPolicies()}},{key:"componentDidUpdate",value:function(e){e.license!==this.props.license&&this.displayPolicies()}},{key:"getBreach",value:function(e){if(this.props.breachs){var t=!0,a=!1,n=void 0;try{for(var r,s=this.props.breachs[Symbol.iterator]();!(t=(r=s.next()).done);t=!0){var o=r.value;if(-1!==o.toLowerCase().indexOf(e))return o}}catch(l){a=!0,n=l}finally{try{t||null==s.return||s.return()}finally{if(a)throw n}}}}},{key:"render",value:function(){return r.a.createElement("table",{className:"table bp-licensing"},r.a.createElement("tbody",null,this.state.policies.map(function(e,t){return r.a.createElement("tr",{key:t,title:e.breachError},r.a.createElement("td",null,e.breachError?r.a.createElement("span",{role:"img","aria-label":"Breached"},"\u274c"):r.a.createElement("span",{className:"bp-licensing__check"},"\u2713")),r.a.createElement("td",null,e.name),r.a.createElement("td",null,e.status))})))}}]),t}(r.a.Component),Ca=a(923),Ra=a(911),Sa=a(912),Aa=a(913),xa=function(e){function t(){var e,a;Object(E.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(b.a)(this,(e=Object(y.a)(t)).call.apply(e,[this].concat(r)))).state={isModalOpen:!1,licenseKey:void 0,error:void 0},a.toggleModal=function(){a.setState({isModalOpen:!a.state.isModalOpen,licenseKey:void 0,error:void 0})},a.onInputKeyPress=function(e){"Enter"===e.key&&a.changeKey()},a.onInputChange=function(e){a.setState(Object(je.a)({},e.target.name,e.target.value.trim()))},a}return Object(w.a)(t,e),Object(v.a)(t,[{key:"changeKey",value:function(){var e=Object(u.a)(c.a.mark(function e(){var t=this;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,le.getSecured().post("admin/license/update",{licenseKey:this.state.licenseKey},{timeout:1e4}).then(function(){t.props.refresh&&t.props.refresh(),t.toggleModal()}).catch(function(e){return t.setState({error:e.message})});case 2:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"renderModal",value:function(){var e=this;return r.a.createElement(Ca.a,{isOpen:this.state.isModalOpen,toggle:this.toggleModal},r.a.createElement(Ra.a,{toggle:this.toggleModal},"Enter your license key"),r.a.createElement(Sa.a,null,this.state.error&&r.a.createElement(Fe.a,{color:"danger"},this.state.error),r.a.createElement(Ue.a,null,r.a.createElement(Kt.a,{for:"firstName"},"New License Key"),r.a.createElement(Le.a,{name:"licenseKey",type:"textarea",style:{height:180},onChange:this.onInputChange,onKeyPress:this.onInputKeyPress,value:this.state.licenseKey,autoFocus:!0}))),r.a.createElement(Aa.a,null,r.a.createElement(Ve.a,{color:"primary",onClick:function(){return e.changeKey()}},"Validate & Change")))}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(Ve.a,{size:"sm",color:"primary",outline:!0,onClick:this.toggleModal},"Enter license key"),this.renderModal())}}]),t}(n.Component),Ia=function(e){function t(){var e,a;Object(E.a)(this,t);for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return(a=Object(b.a)(this,(e=Object(y.a)(t)).call.apply(e,[this].concat(s)))).state={waitingForReboot:!1},a.refreshKey=Object(u.a)(c.a.mark(function e(){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,le.getSecured().post("/admin/license/refresh");case 2:return e.next=4,a.props.fetchLicensing();case 4:case"end":return e.stop()}},e,this)})),a.rebootServer=Object(u.a)(c.a.mark(function e(){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,le.getSecured().post("/admin/server/rebootServer");case 3:a.setState({waitingForReboot:!0}),setTimeout(function(){window.location.reload()},1e4),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),a.setState({error:e.t0});case 10:case"end":return e.stop()}},e,this,[[0,7]])})),a.enableProEdition=Object(u.a)(c.a.mark(function e(){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(window.confirm("Are you sure?")){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,e.next=5,le.getSecured().post("/admin/server/config/enablePro");case 5:if(200!==e.sent.status){e.next=9;break}return e.next=9,a.rebootServer();case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(2),a.setState({error:e.t0});case 14:case"end":return e.stop()}},e,this,[[2,11]])})),a.renderProDisabled=function(){return r.a.createElement(Ht.a,null,r.a.createElement(mt.a,null,r.a.createElement(pt.a,{style:{textAlign:"center"},sm:"12",md:{size:10,offset:1}},r.a.createElement("h4",null,"Enable Botpress Professionnal"),r.a.createElement("p",null,"Make you use an ",r.a.createElement("strong",null,"official botpress binary or docker image"),", you won't be able to activate pro otherwise."),r.a.createElement("p",null,r.a.createElement("u",null,"Method 1"),r.a.createElement("br",null),"You can enable Botpress Pro by manually editing the file ",r.a.createElement("strong",null,"data/global/botpress.config.json")," ","and setting the value ",r.a.createElement("strong",null,"pro.enabled")," to true."),r.a.createElement("p",null,r.a.createElement("u",null,"Method 2"),r.a.createElement("br",null)," Click on the button below. This will enable the required configuration and will automatically reboot the server. Please note: Rebooting the server this way will prevent you from reading the logs on screen (except if you output logs to the file system).",r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement(Ve.a,{onClick:a.enableProEdition},"Enable Pro & Reboot Server")))))},a.renderUnofficialBuild=function(){return r.a.createElement(Ht.a,null,r.a.createElement(mt.a,null,r.a.createElement(pt.a,{style:{textAlign:"center"},sm:"12",md:{size:10,offset:1}},r.a.createElement("h4",null,"Unofficial Botpress Build"),r.a.createElement("p",null,"We noticed that you are running a custom build of Botpress, which doesn't contain the Botpress Professional extensions. Make you use an ",r.a.createElement("strong",null,"official botpress binary or docker image"),". You won't be able to activate ",r.a.createElement("strong",null,"Pro")," otherwise."))))},a}return Object(w.a)(t,e),Object(v.a)(t,[{key:"componentDidMount",value:function(){this.props.fetchLicensing()}},{key:"renderReboot",value:function(){return r.a.createElement(Ht.a,null,r.a.createElement(mt.a,null,r.a.createElement(pt.a,{style:{textAlign:"center"},sm:"12",md:{size:10,offset:1}},r.a.createElement("p",null,"Please wait while the server reboots, this may take a couple of seconds."))))}},{key:"renderLicenseStatus",value:function(){return r.a.createElement("div",{className:"license-status "+(this.isLicensed?"licensed":"unlicensed")},r.a.createElement("div",null,r.a.createElement("span",{className:"license-status__badge"}),r.a.createElement("span",{className:"license-status__status"},this.isLicensed?"Licensed":"Unlicensed"),r.a.createElement("span",{className:"license-status__limits"},this.isUnderLimits?"Under Limits":"Limits breached")),r.a.createElement(Ve.a,{color:"link",className:"license-status__refresh",onClick:this.refreshKey},r.a.createElement("svg",{className:"icon",viewBox:"0 0 90 80",xmlns:"http://www.w3.org/2000/svg"},r.a.createElement("path",{d:"M74.59 57.824l10.498-5.863a3 3 0 1 1 2.926 5.238l-17.779 9.93a2.998 2.998 0 0 1-4.16-1.302l-8.934-18.299a3.002 3.002 0 0 1 1.38-4.013 3.005 3.005 0 0 1 4.013 1.38l5.795 11.87A33.02 33.02 0 0 0 72.865 40c0-18.311-14.897-33.207-33.209-33.207-18.31 0-33.206 14.896-33.206 33.207 0 18.312 14.896 33.209 33.206 33.209 1.236 0 2.476-.068 3.685-.202a3 3 0 0 1 .663 5.963 39.448 39.448 0 0 1-4.348.239C18.038 79.208.45 61.619.45 39.999.45 18.38 18.038.792 39.656.792c21.62 0 39.209 17.588 39.209 39.207a39.011 39.011 0 0 1-4.276 17.825z",fillRule:"evenodd"}))))}},{key:"renderFingerprintStatus",value:function(){return r.a.createElement(n.Fragment,null,r.a.createElement("div",{className:"license-infos license-infos--fingerprint"},r.a.createElement("strong",{className:"license-infos__label"},"Cluster fingerprint:"),r.a.createElement("code",null,this.serverFingerprints.cluster_url),r.a.createElement(wa.CopyToClipboard,{text:this.serverFingerprints.cluster_url},r.a.createElement(Ve.a,{color:"link",size:"sm",className:"license-infos__icon"},r.a.createElement("svg",{href:"#",id:"TooltipCopy",height:"15",viewBox:"0 0 16 20",xmlns:"http://www.w3.org/2000/svg"},r.a.createElement("path",{d:"M3.996 0H16v16h-4.004v4H0V4h3.996V0zM6 2v12h8V2H6zM2 6v12h8v-1.997H3.998V6H2z",fill:"#4A4A4A",fillRule:"evenodd"})))),r.a.createElement(Yt.a,{placement:"right",target:"TooltipCopy"},"Copy to clipboard")),this.isWrongFingerprint&&r.a.createElement(Fe.a,{color:"danger"},"Your license fingerprint doesn't match your machine/cluster fingerprints."))}},{key:"renderBody",value:function(){return this.state.waitingForReboot?this.renderReboot():this.props.licensing&&!this.props.licensing.isBuiltWithPro?this.renderUnofficialBuild():this.props.licensing&&!this.props.licensing.isPro?this.renderProDisabled():r.a.createElement(n.Fragment,null,r.a.createElement(mt.a,null,r.a.createElement(pt.a,{sm:"12",lg:"7"},this.renderLicenseStatus(),this.renderFingerprintStatus(),r.a.createElement(xa,{refresh:this.props.fetchLicensing})),r.a.createElement(pt.a,{sm:"12",lg:"5"},r.a.createElement("div",{className:"license-infos"},r.a.createElement("strong",{className:"license-infos__label"},"Friendly name:"),this.license.label||"N/A"),r.a.createElement("div",{className:"license-infos"},r.a.createElement("strong",{className:"license-infos__label"},"Renew date:"),this.renewDate),r.a.createElement("div",{className:"license-infos"},r.a.createElement("strong",{className:"license-infos__label"},"Support:"),this.license.support,r.a.createElement("svg",{className:"license-infos__icon",href:"#",id:"TooltipSupport",width:"15",height:"15",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg"},r.a.createElement("path",{d:"M9 16h2v-2H9v2zm1-16C4.477 0 0 4.477 0 10A10 10 0 1 0 10 0zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm0-14a4 4 0 0 0-4 4h2a2 2 0 1 1 4 0c0 2-3 1.75-3 5h2c0-2.25 3-2.5 3-5a4 4 0 0 0-4-4z",fill:"#4A4A4A",fillRule:"nonzero"})),r.a.createElement(Yt.a,{placement:"right",target:"TooltipSupport"},"This is the support offered by Botpress")),r.a.createElement("div",{className:"license-infos"},r.a.createElement("strong",{className:"license-infos__label"},"Allowed Nodes:"),this.license.limits&&Number(this.license.limits.nodes)+1),r.a.createElement("hr",null),this.props.licensing&&r.a.createElement("div",null,r.a.createElement("h5",null,"Policies"),r.a.createElement(Oa,{license:this.license,breachs:this.props.licensing.breachReasons})))))}},{key:"render",value:function(){return this.props.loading?r.a.createElement(Wt,null):this.renderBody()}},{key:"isUnderLimits",get:function(){return"breached"!==M.a.get(this.props.licensing,"status")}},{key:"isLicensed",get:function(){return"licensed"===M.a.get(this.props.licensing,"status")}},{key:"renewDate",get:function(){return at()(M.a.get(this.props.licensing,"license.paidUntil",new Date)).format("lll")}},{key:"serverFingerprints",get:function(){return M.a.get(this.props.licensing,"fingerprints",{})}},{key:"license",get:function(){return this.props.licensing&&this.props.licensing.license||{}}},{key:"isWrongFingerprint",get:function(){return!!(this.serverFingerprints&&this.license&&this.license.fingerprint)&&this.serverFingerprints[this.license.fingerprintType]!==this.license.fingerprint}}]),t}(r.a.Component),Na={fetchLicensing:ce},ja=Object(f.b)(function(e){return{loading:e.license.loading,licensing:e.license.licensing}},Na)(Ia),Pa=a(42),Ta=function(e){var t=e.data,a=[{Header:"Host",accessor:"host"},{Header:"Uptime",Cell:function(e){var t=at.a.duration(e.value,"seconds").asMinutes();return"".concat(Math.round(t)," mins")},width:120,className:"center",accessor:"uptime"},{Header:"Peak CPU Usage",Cell:function(e){return e.value+"%"},width:120,accessor:"cpu.usage"},{Header:"Peak Mem Usage",Cell:function(e){return e.value+"%"},width:120,accessor:"mem.usage"},{Header:"Requests",width:120,className:"center",accessor:"requests.count"},{Header:"Events In",width:120,className:"center",accessor:"eventsIn.count",align:"right"},{Header:"Events Out",width:120,className:"center",accessor:"eventsOut.count"},{Header:"Warnings",width:120,className:"center",accessor:"warnings.count"},{Header:"Errors",width:120,className:"center",accessor:"errors.count"}];return r.a.createElement(Zt.a,{columns:a,data:t,defaultPageSize:5,defaultSorted:[{id:"host"}],className:"-striped -highlight monitoringOverview"})},Ba=function(e){var t=e.payload,a=e.date,n=e.uniqueHosts;return r.a.createElement("div",{className:"graphToolTip"},r.a.createElement("table",{cellSpacing:0,cellPadding:0},r.a.createElement("tbody",null,r.a.createElement("tr",null,r.a.createElement("td",{colSpan:10,style:{textAlign:"center"}},at()(a).format("HH:mm:ss"))),r.a.createElement("tr",null,r.a.createElement("th",null,"Host "),t.map(function(e){return r.a.createElement("th",{style:{color:e.stroke||e.fill},key:e.name},e.name)})),n.map(function(e){return r.a.createElement("tr",{key:e},r.a.createElement("td",null,e),t.map(function(t){return r.a.createElement("td",{style:{color:t.stroke||t.fill},key:t.name},M.a.get(t.payload.hosts[e],t.dataKey.replace("summary.",""))," ",t.unit)}))}))))},Ma=a(187),Da=[{value:"1m",label:"1 minute"},{value:"5m",label:"5 minutes"},{value:"10m",label:"10 minutes"},{value:"15m",label:"15 minutes"},{value:"30m",label:"30 minutes"},{value:"1h",label:"1 hour"},{value:"2h",label:"2 hours"},{value:"5h",label:"5 hours"}],Fa=[{value:"10s",label:"10 seconds"},{value:"30s",label:"30 seconds"},{value:"1m",label:"1 minutes"},{value:"5m",label:"5 minutes"},{value:"15m",label:"15 minutes"},{value:"30m",label:"30 minutes"},{value:"1h",label:"1 hour"}],Ua={fontSize:11},La=function(e){function t(){var e,a;Object(E.a)(this,t);for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return(a=Object(b.a)(this,(e=Object(y.a)(t)).call.apply(e,[this].concat(s)))).state={intervalId:null,timeFrame:null,resolution:null,rawStats:null,preparedStats:null,timeFrameOptions:Da},a.handleTimeFrameChanged=function(e){return a.setState({timeFrame:e},a.queryData)},a.handleResolutionChanged=function(e){return a.setState({resolution:e},a.queryData)},a.handleAutoRefreshChanged=function(e){var t=e.target.checked,n=void 0;t&&!a.state.intervalId?n=setInterval(function(){return a.props.refreshStats()},1e4):!t&&a.state.intervalId&&clearInterval(a.state.intervalId),a.setState({autoRefresh:t,intervalId:n})},a.renderTooltip=function(e){var t=e.active,n=e.payload,s=e.label;if(t&&n)return r.a.createElement(Ba,{payload:n,uniqueHosts:a.state.uniqueHosts,date:s})},a}return Object(w.a)(t,e),Object(v.a)(t,[{key:"componentDidMount",value:function(){this.setState({timeFrame:Da[3],resolution:M.a.head(Fa)},this.queryData)}},{key:"componentWillUnmount",value:function(){this.state.intervalId&&clearInterval(this.state.intervalId)}},{key:"componentDidUpdate",value:function(e){e.rawStats!==this.props.rawStats&&this.prepareForDisplay()}},{key:"queryData",value:function(){var e=Object(u.a)(c.a.mark(function e(){var t,a;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.state.timeFrame){e.next=2;break}return e.abrupt("return");case 2:try{t=at()().subtract(z()(this.state.timeFrame.value)).toDate().getTime(),a=at()().toDate().getTime(),this.props.fetchStats(t,a)}catch(n){this.setState({error:n.message})}case 3:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"prepareForDisplay",value:function(){if(this.props.rawStats&&this.props.rawStats.length){var e=M.a.sortBy(M.a.uniqBy(M.a.orderBy(this.props.rawStats,["ts"],["desc"]),"host"),"host"),t=M.a.map(e,"host");this.setState({uniqueHosts:t,lastUniqueEntries:e});var a=Object(Ma.groupEntriesByTime)(this.props.rawStats,this.state.resolution.value),n=Object(Ma.mergeEntriesByTime)(a,t);this.setState({preparedStats:n})}}},{key:"renderOverview",value:function(){var e=this,t=[];return this.state.lastUniqueEntries.forEach(function(a){t.push(Object(I.a)({host:a.host,uptime:a.uptime},Object(Ma.calculateOverviewForHost)(M.a.filter(e.props.rawStats,function(e){return e.host===a.host}))))}),r.a.createElement(Ta,{data:t})}},{key:"renderCpu",value:function(){return r.a.createElement(Pa.g,{height:300},r.a.createElement(Pa.f,{data:this.state.preparedStats},r.a.createElement(Pa.b,{strokeDasharray:"3 3"}),r.a.createElement(Pa.i,{dataKey:"ts",tickFormatter:function(e){return at()(e).format("HH:mm")},scale:"time",tick:Ua}),r.a.createElement(Pa.j,{domain:[0,100],unit:"%",tick:Ua,width:50}),r.a.createElement(Pa.j,{yAxisId:"r",orientation:"right",width:30}),r.a.createElement(Pa.h,{content:this.renderTooltip}),r.a.createElement(Pa.d,null),r.a.createElement(Pa.e,{name:"Memory Usage",dataKey:"summary.mem.usage",unit:"%",stroke:"#1C4E80",strokeWidth:2,dot:!1,activeDot:{r:5}}),r.a.createElement(Pa.e,{name:"CPU Usage",dataKey:"summary.cpu.usage",unit:"%",stroke:"#0091D5",strokeWidth:2,dot:!1,activeDot:{r:5}})))}},{key:"renderMeasures",value:function(){return r.a.createElement(Pa.g,{height:300},r.a.createElement(Pa.c,{data:this.state.preparedStats},r.a.createElement(Pa.b,{strokeDasharray:"3 3"}),r.a.createElement(Pa.i,{dataKey:"ts",tickFormatter:function(e){return at()(e).format("HH:mm")},tick:Ua}),r.a.createElement(Pa.j,{yAxisId:"l",domain:[0,"dataMax"],tick:Ua,width:50}),r.a.createElement(Pa.j,{yAxisId:"r",domain:[0,"dataMax"],tick:Ua,width:30,orientation:"right"}),r.a.createElement(Pa.h,{content:this.renderTooltip}),r.a.createElement(Pa.d,null),r.a.createElement(Pa.a,{stackId:"stack",yAxisId:"l",name:"HTTP Requests",dataKey:"summary.requests.count",fill:"#1C4E80"}),r.a.createElement(Pa.a,{stackId:"stack",yAxisId:"l",name:"Events In",dataKey:"summary.eventsIn.count",fill:"#7E909A"}),r.a.createElement(Pa.a,{stackId:"stack",yAxisId:"l",name:"Events Out",dataKey:"summary.eventsOut.count",fill:"#6AB187"}),r.a.createElement(Pa.e,{yAxisId:"r",name:"Warnings",dataKey:"summary.warnings.count",stroke:"#DBAE58",strokeWidth:2,dot:!1}),r.a.createElement(Pa.e,{yAxisId:"r",name:"Errors",dataKey:"summary.errors.count",stroke:"#AC3E31",strokeWidth:2,dot:!1})))}},{key:"renderCharts",value:function(){return this.state.preparedStats?r.a.createElement("div",{className:"monitoring"},r.a.createElement(mt.a,null,r.a.createElement(pt.a,{md:6},r.a.createElement("h5",null,"CPU & Memory Usage (average)"),this.renderCpu()),r.a.createElement(pt.a,{md:6},r.a.createElement("h5",null,"Metrics (total)"),this.renderMeasures())),r.a.createElement(mt.a,null,r.a.createElement(pt.a,{md:12},r.a.createElement("h5",null,"Overview"),this.renderOverview()))):null}},{key:"renderHeader",value:function(){var e={control:function(e){return Object(I.a)({},e,{minHeight:30})},dropdownIndicator:function(e){return Object(I.a)({},e,{padding:4})},clearIndicator:function(e){return Object(I.a)({},e,{padding:4})},valueContainer:function(e){return Object(I.a)({},e,{padding:"0px 6px"})},input:function(e){return Object(I.a)({},e,{margin:0,padding:0})}};return r.a.createElement(mt.a,{style:{fontSize:"80%"}},r.a.createElement(pt.a,{md:6},r.a.createElement("h3",null,"Botpress Server Monitoring")),r.a.createElement(pt.a,{md:1}),r.a.createElement(pt.a,{md:2},r.a.createElement("strong",null,"Time Frame"),r.a.createElement(zt.a,{styles:e,options:Da,value:this.state.timeFrame,onChange:this.handleTimeFrameChanged,isSearchable:!1})),r.a.createElement(pt.a,{md:2},r.a.createElement("strong",null,"Resolution"),r.a.createElement(zt.a,{styles:e,options:Fa,value:this.state.resolution,onChange:this.handleResolutionChanged,isSearchable:!1})),r.a.createElement(pt.a,{md:1},r.a.createElement("strong",null,"Auto-Refresh"),r.a.createElement("br",null),r.a.createElement(Kt.a,null,r.a.createElement("input",{style:{marginTop:8},name:"autoRefresh",type:"checkbox",value:this.state.autoRefresh,onChange:this.handleAutoRefreshChanged})," ",r.a.createElement("strong",null,"Enabled"))))}},{key:"renderNoStats",value:function(){return r.a.createElement(Ht.a,null,r.a.createElement(mt.a,null,r.a.createElement(pt.a,{style:{textAlign:"center"},sm:"12",md:{size:8,offset:2}},r.a.createElement("h1",null,r.a.createElement(Vt.a,null),"\xa0 Monitoring is not enabled or there is no statistics."),r.a.createElement("p",null,"Make sure that monitoring is enabled in your Botpress Config."))))}},{key:"render",value:function(){return this.props.loading?r.a.createElement(Wt,null):this.props.rawStats?r.a.createElement(dt.a,null,this.renderHeader(),this.renderCharts()):this.renderNoStats()}}]),t}(n.Component),Va={fetchStats:function(e,t){return function(){var a=Object(u.a)(c.a.mark(function a(n){var r,s;return c.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return n({type:"monitoring/FETCH_STATS_FULL_REQUESTED"}),a.next=3,le.getSecured().post("/admin/server/monitoring",{fromTime:e,toTime:t});case 3:r=a.sent,s=r.data,n({type:"monitoring/FETCH_STATS_FULL_RECEIVED",stats:s&&s.map(JSON.parse),toTime:t});case 6:case"end":return a.stop()}},a,this)}));return function(e){return a.apply(this,arguments)}}()},refreshStats:function(){return function(){var e=Object(u.a)(c.a.mark(function e(t,a){var n,r,s,o,l;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=a(),r=n.monitoring,s=at()().toDate().getTime(),e.next=4,le.getSecured().post("/admin/server/monitoring",{fromTime:r.lastDate,toTime:s});case 4:o=e.sent,l=o.data,t({type:"bots/FETCH_STATS_PARTIAL_RECEIVED",stats:l&&l.map(JSON.parse),toTime:s});case 7:case"end":return e.stop()}},e,this)}));return function(t,a){return e.apply(this,arguments)}}()}},Ha=Object(f.b)(function(e){return{rawStats:e.monitoring.stats,lastDate:e.monitoring.lastDate,loading:e.monitoring.loading}},Va)(La),Ka=function(e){function t(){var e,a;Object(E.a)(this,t);for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return(a=Object(b.a)(this,(e=Object(y.a)(t)).call.apply(e,[this].concat(s)))).state={command:"",copied:!1},a.setPullCommand=function(){var e=-1!==navigator.appVersion.indexOf("Win")?"bp.exe":"./bp",t=J().token,n=window.location.origin,r="".concat(e," pull --url ").concat(n," --authToken ").concat(t," --targetDir data");a.setState({command:r})},a.setCopied=function(){a.setState({copied:!0})},a.renderNoPendingChanges=function(){return r.a.createElement(Ht.a,null,r.a.createElement(mt.a,null,r.a.createElement(pt.a,{style:{textAlign:"center"},sm:"12",md:{size:8,offset:2}},r.a.createElement("h1",null,r.a.createElement(sa.k,null),"\xa0You're all set"),r.a.createElement("p",null,"No changes have been made on this server yet."))))},a.renderMainContent=function(){return r.a.createElement("div",null,a.props.loading&&r.a.createElement("div",null,"loading"),!a.props.loading&&M.a.isEmpty(a.props.pendingChanges)&&a.renderNoPendingChanges(),!a.props.loading&&!M.a.isEmpty(a.props.pendingChanges)&&r.a.createElement("div",null,r.a.createElement("p",null,"Some changes has been made since this server was deployed. Run the botpress pull command to sync server data locally"),r.a.createElement("code",null,a.state.command),r.a.createElement(ka.a,{text:a.state.command,onCopy:a.setCopied},r.a.createElement(Ve.a,{color:"link",size:"sm",className:"license-infos__icon"},r.a.createElement("svg",{href:"#",id:"TooltipCopy",height:"15",viewBox:"0 0 16 20",xmlns:"http://www.w3.org/2000/svg"},r.a.createElement("path",{d:"M3.996 0H16v16h-4.004v4H0V4h3.996V0zM6 2v12h8V2H6zM2 6v12h8v-1.997H3.998V6H2z",fill:"#4A4A4A",fillRule:"evenodd"})))),a.state.copied&&r.a.createElement("span",null,"\xa0copied")))},a}return Object(w.a)(t,e),Object(v.a)(t,[{key:"componentDidMount",value:function(){this.props.fetchPendingChanges(),this.setPullCommand()}},{key:"render",value:function(){return this.renderMainContent()}}]),t}(n.Component),za=Object(f.b)(function(e){return Object(I.a)({},e.versioning)},{fetchPendingChanges:function(){return function(){var e=Object(u.a)(c.a.mark(function e(t){var a,n;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t({type:"versioning/FETCH_PENDING_CHANGES"}),e.next=3,le.getSecured().get("/admin/versioning/pending");case 3:a=e.sent,n=a.data,t({type:"versioning/RECEIVE_PENDING_CHANGES",pendingChanges:n});case 6:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()}})(Ka),Ya=function(e){var t=[{name:"Languages",route:"/server/languages",icon:r.a.createElement(Mt.a,{icon:"globe-network"}),component:ya},{name:"Monitoring",route:"/server/monitoring",icon:r.a.createElement(Mt.a,{icon:"timeline-line-chart"}),useFullWidth:!0,proOnly:!0,component:Ha},{name:"Incidents",route:"/server/alerting",icon:r.a.createElement(Mt.a,{icon:"notifications"}),useFullWidth:!1,proOnly:!0,component:ea},{name:"Server License",route:"/server/license",icon:r.a.createElement(gt.d,null),component:ja},{name:"Version Control",route:"/server/version",icon:r.a.createElement(Mt.a,{icon:"changes"}),component:za},{name:"Debug",route:"/server/debug",icon:r.a.createElement(Mt.a,{icon:"console"}),component:la}];return r.a.createElement(kt,Object(I.a)({title:"Server",tabs:t},e,{showHome:!0}))},qa=a(914),Za={botId:"",name:"",generateId:!0,template:null,category:null,error:null},Ja=function(e){function t(){var e,a;Object(E.a)(this,t);for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return(a=Object(b.a)(this,(e=Object(y.a)(t)).call.apply(e,[this].concat(s)))).state=Object(I.a)({},Za),a.focus=function(){a.nameInput.focus()},a.isFormValid=function(){return a.formEl&&a.formEl.checkValidity()&&a.state.template},a.handleNameChanged=function(e){var t=e.target.value;a.setState({name:t,botId:a.state.generateId?a.sanitizeBotId(t):a.state.botId})},a.handleBotIdChanged=function(e){return a.setState({botId:a.sanitizeBotId(e.target.value),generateId:!1})},a.handleTemplateChanged=function(e){return a.setState({template:e})},a.handleCategoryChanged=function(e){return a.setState({category:e})},a.sanitizeBotId=function(e){return e.toLowerCase().replace(/\s/g,"-").replace(/[^a-z0-9_-]/g,"")},a.createBot=function(){var e=Object(u.a)(c.a.mark(function e(t){var n,r,s,o,l;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),a.isFormValid()){e.next=3;break}return e.abrupt("return");case 3:return n=a.state,r=n.botId,s=n.name,o=M.a.pick(a.state.template,["id","moduleId"]),l=a.state.category?a.state.category.value:null,e.prev=6,e.next=9,le.getSecured().post("/admin/bots",{id:r,name:s,template:o,category:l});case 9:a.setState(Object(I.a)({},Za)),a.props.onCreateBotSuccess&&a.props.onCreateBotSuccess(),a.props.toggle(),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(6),a.setState({error:e.t0.message});case 17:case"end":return e.stop()}},e,this,[[6,14]])}));return function(t){return e.apply(this,arguments)}}(),a.renderTemplateGroupSelect=function(){var e=M.a.groupBy(a.props.botTemplates,"moduleName"),t=M.a.toPairs(e).map(function(e){return{label:e[0],options:e[1]}});return r.a.createElement(zt.a,{tabIndex:"2",getOptionLabel:function(e){return e.name},getOptionValue:function(e){return e.id},options:t,value:a.state.template,onChange:a.handleTemplateChanged})},a.toggle=function(){a.setState(Object(I.a)({},Za)),a.props.toggle()},a}return Object(w.a)(t,e),Object(v.a)(t,[{key:"componentDidMount",value:function(){this.props.botCategoriesFetched||this.props.fetchBotCategories(),this.props.templateFetched||this.props.fetchBotTemplates()}},{key:"render",value:function(){var e=this;return r.a.createElement(Ca.a,{isOpen:this.props.isOpen,toggle:this.toggle,fade:!1,onOpened:this.focus},r.a.createElement(Ra.a,{toggle:this.props.toggle},"Create a new bot"),r.a.createElement(Sa.a,null,r.a.createElement("form",{onSubmit:this.createBot,ref:function(t){return e.formEl=t}},r.a.createElement(Ue.a,null,r.a.createElement(Kt.a,{for:"name"},r.a.createElement("strong",null,"Name of your bot"),r.a.createElement("br",null),r.a.createElement("small",null,'It will be displayed to your visitors. You can change it anytime. If you put nothing, it will be named "Bot" by default.')),r.a.createElement(Le.a,{tabIndex:"1",innerRef:function(t){return e.nameInput=t},type:"text",id:"name",value:this.state.name,onChange:this.handleNameChanged}),r.a.createElement(qa.a,null,"The bot name should have at least 4 characters.")),r.a.createElement(Ue.a,null,r.a.createElement(Kt.a,{for:"id"},r.a.createElement("strong",null,"Your bot ID *"),r.a.createElement("br",null),r.a.createElement("small",null,"This ID cannot be changed, so choose wisely. It will be displayed in the URL and your visitors can see it. Special characters are not allowed. Minimum length: 3")),r.a.createElement(Le.a,{tabIndex:"2",required:!0,type:"text",minLength:3,value:this.state.botId,onChange:this.handleBotIdChanged}),r.a.createElement(qa.a,null,"The bot id should have at least 4 characters.")),this.props.botTemplates.length>0&&r.a.createElement(Ue.a,null,r.a.createElement(Kt.a,{for:"template"},r.a.createElement("strong",null,"Bot Template *")),this.renderTemplateGroupSelect()),this.props.botCategories.length>0&&r.a.createElement(Ue.a,null,r.a.createElement(Kt.a,{for:"category"},r.a.createElement("strong",null,"Bot Category")),r.a.createElement(zt.a,{tabIndex:"3",options:this.props.botCategories.map(function(e){return{label:e,value:e}}),value:this.state.category,onChange:this.handleCategoryChanged})),r.a.createElement(Ve.a,{tabIndex:"4",className:"float-right",type:"submit",color:"primary",disabled:!this.isFormValid()},r.a.createElement(sa.i,null)," Create bot")),!!this.state.error&&r.a.createElement("p",{className:"text-danger"},this.state.error)))}}]),t}(n.Component),_a={fetchBotTemplates:function(){return function(){var e=Object(u.a)(c.a.mark(function e(t){var a,n;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,le.getSecured().get("/modules/botTemplates");case 2:a=e.sent,n=a.data,t({type:"bots/RECEIVED_BOT_TEMPLATES",templates:n});case 5:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},fetchBotCategories:Ge},Qa=Object(f.b)(function(e){return Object(I.a)({},e.bots)},_a)(Ja),Wa={botId:"",error:null,file:null,fileValue:null,idTaken:!1},Ga=function(e){function t(){var e,a;Object(E.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(b.a)(this,(e=Object(y.a)(t)).call.apply(e,[this].concat(r)))).state=Object(I.a)({},Wa),a.focus=function(){a.IdInput&&a.IdInput.focus()},a.isFormValid=function(){return a.formEl&&a.formEl.checkValidity()&&null!==a.state.fileValue&&!a.state.idTaken},a.importBot=function(){var e=Object(u.a)(c.a.mark(function e(t){var n;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),n=a.state.botId,e.prev=2,e.next=5,le.getSecured().post("/admin/bots/".concat(n,"/import"),a.state.fileValue,{headers:{"Content-Type":"application/tar+gzip"}});case 5:a.setState(Object(I.a)({},Wa)),a.props.onCreateBotSuccess&&a.props.onCreateBotSuccess(),a.props.toggle(),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(2),a.setState({error:e.t0.message});case 13:case"end":return e.stop()}},e,this,[[2,10]])}));return function(t){return e.apply(this,arguments)}}(),a.sanitizeBotId=function(e){return e.toLowerCase().replace(/\s/g,"-").replace(/[^a-z0-9_-]/g,"")},a.checkIdAvailability=M.a.debounce(function(){var e=Object(u.a)(c.a.mark(function e(t){var n,r;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=3;break}return a.setState({idTaken:!1}),e.abrupt("return");case 3:return e.prev=3,e.next=6,le.getSecured().get("/admin/bots/".concat(t,"/exists"));case 6:n=e.sent,r=n.data,a.setState({idTaken:r}),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(3),a.setState({error:e.t0.message});case 14:case"end":return e.stop()}},e,this,[[3,11]])}));return function(t){return e.apply(this,arguments)}}(),500),a.handleBotIdChanged=function(e){var t=a.sanitizeBotId(e.target.value);a.checkIdAvailability(t),a.setState({botId:t})},a.handleFileChanged=function(e){var t=e.target,n=t.value,r=t.files,s=new FileReader;s.readAsArrayBuffer(r[0]),s.onload=function(e){a.setState({fileValue:e.target.result})},a.setState({file:n})},a.toggle=function(){a.setState(Object(I.a)({},Wa)),a.props.toggle()},a}return Object(w.a)(t,e),Object(v.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement(Ca.a,{isOpen:this.props.isOpen,toggle:this.toggle,fade:!1,onOpened:this.focus},r.a.createElement(Ra.a,{toggle:this.props.toggle},"Import a new bot"),r.a.createElement(Sa.a,null,r.a.createElement("form",{onSubmit:this.importBot,ref:function(t){return e.formEl=t}},r.a.createElement(Ue.a,null,r.a.createElement(Kt.a,{for:"id"},r.a.createElement("strong",null,"Bot ID")," ",this.state.idTaken&&r.a.createElement("span",{className:"text-danger"},"Already Taken")),r.a.createElement(Le.a,{innerRef:function(t){return e.IdInput=t},tabIndex:"-1",required:!0,type:"text",minLength:3,value:this.state.botId,onChange:this.handleBotIdChanged}),r.a.createElement("small",null,"This ID cannot be changed, so choose wisely. It will be displayed in the URL and your visitors can see it. Special characters are not allowed. Minimum length: 4"),r.a.createElement(qa.a,null,"The bot id should have at least 4 characters.")),r.a.createElement(Ue.a,null,r.a.createElement(Kt.a,{for:"file"},r.a.createElement("strong",null,"Bot file")),r.a.createElement(Le.a,{tabIndex:"1",type:"file",id:"file",value:this.state.file,onChange:this.handleFileChanged}),r.a.createElement(qa.a,null,"Zip file with the bot content.")),r.a.createElement(Ve.a,{tabIndex:"4",className:"float-right",type:"submit",color:"primary",disabled:!this.isFormValid()},r.a.createElement(gt.s,null)," Import bot")),!!this.state.error&&r.a.createElement("p",{className:"text-danger"},this.state.error)))}}]),t}(n.Component),Xa=a(922),$a=a(915),en=a(916),tn=a(917),an=a(918),nn=function(e){var t=e.bot,a=e.requestStageChange,n=e.deleteBot,s=e.exportBot,o=e.permissions,l=e.allowStageChange,i=e.history,c=e.createRevision,u=e.rollback;return r.a.createElement("div",{className:"pipeline_bot",key:t.id},r.a.createElement("div",{className:"actions"},r.a.createElement(Xa.a,null,r.a.createElement($a.a,{tag:"span",className:"more"},r.a.createElement(gt.n,null)),r.a.createElement(en.a,null,!t.disabled&&r.a.createElement(r.a.Fragment,null,r.a.createElement(tn.a,{tag:"a",target:"_blank",href:"".concat(window.location.origin,"/s/").concat(t.id)},r.a.createElement(Vt.b,null)," \xa0Open chat"),r.a.createElement(tn.a,{disabled:t.locked,tag:"a",href:"/studio/".concat(t.id)},r.a.createElement(gt.m,null),"\xa0Edit in studio")),l&&r.a.createElement(tn.a,{onClick:a},r.a.createElement(gt.r,null),"\xa0Promote to next stage"),r.a.createElement(vt,{permissions:o,resource:"admin.bots.*",operation:"write"},r.a.createElement(tn.a,{disabled:t.locked,onClick:function(){return i.push("/bot/".concat(t.id,"/details"))}},r.a.createElement(sa.d,null),"\xa0Configs"),r.a.createElement(tn.a,{onClick:c},r.a.createElement(gt.c,null),"\xa0Create revision"),r.a.createElement(tn.a,{onClick:u},r.a.createElement(gt.q,null),"\xa0Rollback"),r.a.createElement(tn.a,{onClick:s},r.a.createElement(gt.b,null),"\xa0Export"),r.a.createElement(tn.a,{onClick:n},r.a.createElement(gt.e,null),"\xa0Delete"))))),r.a.createElement("div",{className:"title"},t.locked&&r.a.createElement("span",null,r.a.createElement(gt.l,{className:"text-primary"}),"\xa0"),t.disabled?r.a.createElement("span",null,t.name):r.a.createElement("a",{href:"/studio/".concat(t.id)},t.name),!t.defaultLanguage&&r.a.createElement(r.a.Fragment,null,r.a.createElement(gt.u,{id:"".concat(t.id,"-warn"),className:"text-danger"}),r.a.createElement(Yt.a,{placement:"right",target:"".concat(t.id,"-warn")},"Bot language is missing. Please set it in bot config."))),r.a.createElement("p",null,t.description),r.a.createElement("div",null,t.disabled&&r.a.createElement(an.a,{color:"warning",className:"botbadge"},"disabled"),t.private&&r.a.createElement(an.a,{color:"primary",className:"botbadge"},"private"),t.pipeline_status.stage_request&&r.a.createElement(r.a.Fragment,null,r.a.createElement(an.a,{color:"secondary",className:"botbadge",id:"status-badge"},t.pipeline_status.stage_request.status),r.a.createElement(Yt.a,{placement:"bottom",target:"status-badge"},r.a.createElement("p",null,"Requested by: ",t.pipeline_status.stage_request.requested_by," ",r.a.createElement("br",null),"on\xa0",new Date(t.pipeline_status.stage_request.requested_on).toLocaleDateString()),t.pipeline_status.stage_request.message&&r.a.createElement("p",null,t.pipeline_status.stage_request.message)))))},rn=function(e){var t=e.bot,a=e.deleteBot,n=e.exportBot,s=e.permissions,o=e.history,l=e.createRevision,i=e.rollback;return r.a.createElement("div",{className:"bp_table-row",key:t.id},r.a.createElement("div",{className:"actions"},r.a.createElement(vt,{permissions:s,resource:"admin.bots.*",operation:"write"},r.a.createElement(Ve.a,{size:"sm",color:"link",onClick:function(){return o.push("/bot/".concat(t.id,"/details"))}},r.a.createElement(sa.d,null)," Configs")),!t.disabled&&r.a.createElement(Ve.a,{size:"sm",color:"link",target:"_blank",href:"".concat(window.location.origin,"/s/").concat(t.id)},r.a.createElement(Vt.b,null)," Open chat"),r.a.createElement(Xa.a,null,r.a.createElement($a.a,{tag:"span",className:"more"},r.a.createElement(gt.n,null)),r.a.createElement(en.a,null,!t.disabled&&r.a.createElement(tn.a,{disabled:t.locked,tag:"a",href:"/studio/".concat(t.id)},r.a.createElement(gt.m,null),"\xa0Edit in studio"),r.a.createElement(vt,{permissions:s,resource:"admin.bots.*",operation:"write"},r.a.createElement(tn.a,{onClick:l},r.a.createElement(gt.c,null),"\xa0Create revision"),r.a.createElement(tn.a,{onClick:i},r.a.createElement(gt.q,null),"\xa0Rollback"),r.a.createElement(tn.a,{onClick:n},r.a.createElement(gt.b,null),"\xa0Export"),r.a.createElement(tn.a,{onClick:a},r.a.createElement(gt.e,null),"\xa0Delete"))))),r.a.createElement("div",{className:"title"},t.locked&&r.a.createElement("span",null,r.a.createElement(gt.l,{className:"text-primary"}),"\xa0"),t.disabled?r.a.createElement("span",null,t.name||t.id):r.a.createElement("a",{href:"/studio/".concat(t.id)},t.name||t.id),!t.defaultLanguage&&r.a.createElement(r.a.Fragment,null,r.a.createElement(gt.u,{id:"".concat(t.id,"-warn"),className:"text-danger"}),r.a.createElement(Yt.a,{placement:"right",target:"".concat(t.id,"-warn")},"Bot language is missing. Please set it in bot config.")),t.disabled&&r.a.createElement(an.a,{color:"warning",className:"botbadge"},"disabled"),t.private&&r.a.createElement(an.a,{color:"primary",className:"botbadge"},"private")),r.a.createElement("p",null,t.description))},sn={revisions:[],selectedRev:null},on=function(e){function t(){var e,a;Object(E.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(b.a)(this,(e=Object(y.a)(t)).call.apply(e,[this].concat(r)))).state=Object(I.a)({},sn),a.fetchRevisions=function(){return le.getSecured().get("/admin/bots/".concat(a.props.botId,"/revisions")).then(function(e){var t=e.data.payload.revisions.map(function(e){var t=e.replace(".tgz","").split("++");return t[1]=new Date(parseInt(t[1],10)).toLocaleString(),{label:t.join(" - "),value:e}});a.setState({revisions:t})})},a.selectRev=function(e){a.setState({selectedRev:e},function(){a.submitEl.focus()})},a.rollback=function(){window.confirm("Are you sure you want to rollback bot ".concat(a.props.botId,"? All its content and flows will be overwritten"))&&le.getSecured().post("/admin/bots/".concat(a.props.botId,"/rollback"),{revision:a.state.selectedRev.value}).then(function(){a.props.onRollbackSuccess&&a.props.onRollbackSuccess(),a.props.toggle(),a.setState(Object(I.a)({},sn))})},a.focus=function(){a.selectEl.focus()},a}return Object(w.a)(t,e),Object(v.a)(t,[{key:"componentDidUpdate",value:function(){var e=Object(u.a)(c.a.mark(function e(t){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.props.botId||t.botId===this.props.botId){e.next=3;break}return e.next=3,this.fetchRevisions();case 3:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return r.a.createElement(Ca.a,{isOpen:this.props.isOpen,toggle:this.props.toggle,fade:!1,onOpened:this.focus,autoFocus:!1},r.a.createElement(Ra.a,{toggle:this.props.toggle},"Rollback bot ",this.props.botId||""),r.a.createElement(Sa.a,null,r.a.createElement("p",null,"Select from the available revisions below"),r.a.createElement(Ue.a,null,r.a.createElement(Kt.a,{for:"name"},r.a.createElement("strong",null,"Revisions")),r.a.createElement(zt.a,{tabIndex:"1",ref:function(t){return e.selectEl=t},value:this.state.selectedRev,options:this.state.revisions,onChange:this.selectRev})),r.a.createElement(Ve.a,{tabIndex:"2",className:"float-right",type:"submit",color:"primary",disabled:!this.state.selectedRev,onClick:this.rollback,innerRef:function(t){return e.submitEl=t}},r.a.createElement(gt.q,null)," Rollback"),!!this.state.error&&r.a.createElement("p",{className:"text-danger"},this.state.error)))}}]),t}(n.Component),ln=a(417),cn=a(150),un=function(e){function t(){var e,a;Object(E.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(b.a)(this,(e=Object(y.a)(t)).call.apply(e,[this].concat(r)))).state={isCreateBotModalOpen:!1,focusedBot:null,isRollbackModalOpen:!1},a.toggleCreateBotModal=function(){a.setState({isCreateBotModalOpen:!a.state.isCreateBotModalOpen})},a.toggleImportBotModal=function(){a.setState({isImportBotModalOpen:!a.state.isImportBotModalOpen})},a.hasUnlangedBots=function(){return a.props.bots.reduce(function(e,t){return e||!t.defaultLanguage},!1)},a.isLicensed=function(){return"licensed"===M.a.get(a.props.licensing,"status")},a.toggleRollbackModal=function(e){a.setState({focusedBot:"string"===typeof e?e:null,isRollbackModalOpen:!a.state.isRollbackModalOpen})},a.handleRollbackSuccess=function(){a.props.fetchBots(),l.toast.success("Rollback success")},a}return Object(w.a)(t,e),Object(v.a)(t,[{key:"renderLoading",value:function(){return r.a.createElement(Wt,null)}},{key:"componentDidMount",value:function(){this.downloadLink=r.a.createRef(),this.props.fetchBots(),this.props.fetchPermissions(),this.props.licensing||this.props.fetchLicensing()}},{key:"exportBot",value:function(){var e=Object(u.a)(c.a.mark(function e(t){var a,n,r=this;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,le.getSecured({timeout:1e4})({method:"get",url:"/admin/bots/".concat(t,"/export"),responseType:"blob"});case 2:a=e.sent,n=a.data,this.setState({downloadLinkHref:window.URL.createObjectURL(new Blob([n])),downloadLinkFileName:"bot_".concat(t,"_").concat(Date.now(),".tgz")},function(){return r.downloadLink.current.click()});case 5:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"deleteBot",value:function(){var e=Object(u.a)(c.a.mark(function e(t){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!window.confirm("Are you sure you want to delete this bot? This can't be undone.")){e.next=5;break}return e.next=3,le.getSecured().delete("/admin/bots/".concat(t));case 3:return e.next=5,this.props.fetchBots();case 5:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"renderEmptyBots",value:function(){return r.a.createElement("div",{className:"bots"},r.a.createElement(Ht.a,null,r.a.createElement(mt.a,null,r.a.createElement(pt.a,{style:{textAlign:"center"},sm:"12",md:{size:8,offset:2}},r.a.createElement("h1",null,r.a.createElement(Vt.a,null),"\xa0 This workspace has no bot, yet."),r.a.createElement("p",null,"In Botpress, bots are always assigned to a workspace. Create your first bot to start building.")))))}},{key:"renderCreateNewBotButton",value:function(){var e=this;return r.a.createElement(vt,{permissions:this.props.permissions,resource:"admin.bots.*",operation:"write"},r.a.createElement(me.a,{minimal:!0,interactionKind:me.b.HOVER,position:pe.a.BOTTOM},r.a.createElement(he.b,{intent:ta.a.NONE,text:"Create Bot",rightIcon:"caret-down"}),r.a.createElement(ln.a,{vertical:!0,minimal:!0,fill:!0,alignText:cn.a.LEFT},r.a.createElement(he.b,{text:"New Bot",icon:"add",onClick:function(){return e.setState({isCreateBotModalOpen:!0})}}),r.a.createElement(he.b,{text:"Import Existing",icon:"import",onClick:function(){return e.setState({isImportBotModalOpen:!0})}}))))}},{key:"requestStageChange",value:function(){var e=Object(u.a)(c.a.mark(function e(t){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,le.getSecured().post("/admin/bots/".concat(t,"/stage"));case 2:return e.next=4,this.props.fetchBots();case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"createRevision",value:function(){var e=Object(u.a)(c.a.mark(function e(t){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,le.getSecured().post("admin/bots/".concat(t,"/revisions"));case 2:l.toast.success("Revisions created");case 3:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"renderCompactView",value:function(){var e=this;return this.props.bots.length?r.a.createElement("div",{className:"bp_table bot_views compact_view"},this.props.bots.map(function(t){return r.a.createElement(rn,{key:t.id,bot:t,history:e.props.history,deleteBot:e.deleteBot.bind(e,t.id),exportBot:e.exportBot.bind(e,t.id),permissions:e.props.permissions,createRevision:e.createRevision.bind(e,t.id),rollback:e.toggleRollbackModal.bind(e,t.id)})})):this.renderEmptyBots()}},{key:"renderPipelineView",value:function(){var e=this,t=this.props.workspace.pipeline,a=M.a.groupBy(this.props.bots,"pipeline_status.current_stage.id"),s=Math.floor(12/t.length);return r.a.createElement(n.Fragment,null,r.a.createElement(mt.a,{className:"pipeline_view bot_views"},t.map(function(n,o){var l=e.isLicensed()&&o!==t.length-1;return r.a.createElement(pt.a,{key:n.id,md:s},t.length>1&&r.a.createElement("h3",{className:"pipeline_title"},n.label),0===o&&r.a.createElement("div",{className:"pipeline_bot create"},e.renderCreateNewBotButton()),(a[n.id]||[]).map(function(t){return r.a.createElement(nn,{key:t.id,bot:t,history:e.props.history,allowStageChange:l,requestStageChange:e.requestStageChange.bind(e,t.id),deleteBot:e.deleteBot.bind(e,t.id),exportBot:e.exportBot.bind(e,t.id),permissions:e.props.permissions,createRevision:e.createRevision.bind(e,t.id),rollback:e.toggleRollbackModal.bind(e,t.id)})}))})))}},{key:"renderBots",value:function(){var e=this.isPipelineView?this.renderPipelineView():this.renderCompactView();return r.a.createElement("div",null,this.hasUnlangedBots()&&r.a.createElement(Fe.a,{color:"warning"},"You have bots without specified language. Default language is mandatory since Botpress 11.8. Please set bot language in the bot config page."),e)}},{key:"render",value:function(){return this.props.bots?r.a.createElement(n.Fragment,null,r.a.createElement("a",{ref:this.downloadLink,href:this.state.downloadLinkHref,download:this.state.downloadLinkFileName}," "),r.a.createElement(qt,{title:"Your bots",helpText:"This page lists all the bots created under the default workspace.",activePage:"bots",mainContent:this.renderBots(),sideMenu:!this.isPipelineView&&this.renderCreateNewBotButton()}),r.a.createElement(on,{botId:this.state.focusedBot,isOpen:this.state.isRollbackModalOpen,toggle:this.toggleRollbackModal,onRollbackSuccess:this.handleRollbackSuccess}),r.a.createElement(Qa,{isOpen:this.state.isCreateBotModalOpen,toggle:this.toggleCreateBotModal,onCreateBotSuccess:this.props.fetchBots}),r.a.createElement(Ga,{isOpen:this.state.isImportBotModalOpen,toggle:this.toggleImportBotModal,onCreateBotSuccess:this.props.fetchBots})):r.a.createElement(Wt,null)}},{key:"isPipelineView",get:function(){return this.props.workspace.pipeline.length>1}}]),t}(n.Component),dn={fetchBots:Xe,fetchLicensing:ce,fetchPermissions:we},mn=Object(f.b)(function(e){return{bots:e.bots.bots,workspace:e.bots.workspace,loading:e.bots.loadingBots,permissions:e.user.permissions,licensing:e.license.licensing}},dn)(un),pn=a(267),hn=a.n(pn),fn=function(e){function t(){var e,a;Object(E.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(b.a)(this,(e=Object(y.a)(t)).call.apply(e,[this].concat(r)))).state={needRefresh:!1},a}return Object(w.a)(t,e),Object(v.a)(t,[{key:"componentDidMount",value:function(){this.props.fetchUsers(),this.props.fetchRoles()}},{key:"componentDidUpdate",value:function(){this.state.needRefresh&&(this.props.fetchUsers(),this.setState({needRefresh:!1}))}},{key:"toggle",value:function(e){this.setState(Object(je.a)({},e,!this.state[e]))}},{key:"renderActionButton",value:function(e){var t=this;return r.a.createElement(Xa.a,null,r.a.createElement($a.a,{caret:!0,outline:!0,color:"secondary",size:"sm"},"More"),r.a.createElement(en.a,null,this.props.actions.map(function(a,n){return r.a.createElement(tn.a,{color:a.type?a.type:"link",size:"sm",key:n,onClick:function(){a.onClick(e),a.needRefresh&&t.setState({needRefresh:!0})}},a.label)})))}},{key:"renderUsersForRole",value:function(e,t){var a=this;return r.a.createElement(R.a,{isOpen:this.state[t]},r.a.createElement("div",{className:"bp_table"},e.map(function(e){return r.a.createElement("div",{className:"bp_table-row bp_users-list",key:"user-"+e.email},e.email!==a.props.profile.email&&a.renderActionButton(e),r.a.createElement(Ce,{email:e.email,size:"md",className:"pullLeft"}),r.a.createElement("div",{className:"pullLeft details"},r.a.createElement("div",{className:"nameZone"},e.firstname,"\xa0",e.lastname),r.a.createElement("p",null,r.a.createElement("span",{className:"field"},r.a.createElement("b",null,"Email: "),e.email," (",e.strategy,")"),r.a.createElement("span",{className:"field"},r.a.createElement("b",null,"Last Login: "),e.last_logon?at()(e.last_logon).fromNow():"never"),r.a.createElement("span",{className:"field"},r.a.createElement("b",null,"Joined: "),at()(e.created_on).fromNow()))),r.a.createElement("div",{style:{clear:"both"}}))})))}},{key:"renderRole",value:function(e,t){var a=this;return r.a.createElement("div",{key:"role-"+t.id},r.a.createElement("div",{onClick:function(){return a.toggle(t.id)},className:"bp_users-role_header"},r.a.createElement("div",{className:"role float-left"},r.a.createElement(an.a,{pill:!0,color:"light"},e.length),r.a.createElement("span",{className:"title"},t.name)),this.state[t.id]?r.a.createElement(gt.k,null):r.a.createElement(gt.i,null)),this.renderUsersForRole(e,t.id))}},{key:"renderPage",value:function(){var e=this;return r.a.createElement("div",{className:"bp_users-container"},this.props.roles.map(function(t){var a=e.props.users.filter(function(e){return e.role===t.id});return a.length?e.renderRole(a,t):null}))}},{key:"render",value:function(){return!this.props.users||this.props.loading?r.a.createElement(Wt,null):this.renderPage()}}]),t}(n.Component),gn=Object(f.b)(function(e){return{profile:e.user.profile,roles:e.roles.roles,users:e.user.items,loading:e.user.loadingUsers}},function(e){return Object(Je.b)({fetchUsers:be,fetchRoles:et},e)})(fn),En=a(428),vn=a.n(En),bn=function(e){function t(){var e,a;Object(E.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(b.a)(this,(e=Object(y.a)(t)).call.apply(e,[this].concat(r)))).state={email:"",role:null,displayStrategy:!1,selectedUser:void 0,selectedStrategy:void 0},a.onEmailChanged=function(e){a.setState({email:e.target.value})},a.onRoleChange=function(e){a.setState({role:e.target.value})},a.createUser=function(){var e=Object(u.a)(c.a.mark(function e(t){var n,r,s,o,l,i,u,d;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=a.state,r=n.selectedUser,s=n.selectedStrategy,t.preventDefault(),a.isFormValid()&&r){e.next=4;break}return e.abrupt("return");case 4:if(!r.__isNew__){e.next=12;break}return e.next=7,le.getSecured().post("/admin/users",{email:r.value,strategy:s.value,role:a.state.role});case 7:o=e.sent,l=o.data,a.props.onUserCreated&&a.props.onUserCreated(l.payload),e.next=16;break;case 12:return i=r.value,u=i.email,d=i.strategy,e.next=15,le.getSecured().post("/admin/users/workspace/add",{email:u,strategy:d,role:a.state.role});case 15:a.props.onUserAdded&&a.props.onUserAdded();case 16:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),a.isFormValid=function(){return a.formEl&&a.formEl.checkValidity()},a.findUsers=function(){var e=Object(u.a)(c.a.mark(function e(t){var n;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.length&&a.state.users){e.next=2;break}return e.abrupt("return");case 2:return n=t.toLowerCase(),e.abrupt("return",a.state.users.filter(function(e){return e.email.toLowerCase().includes(n)}).map(function(e){return{label:"".concat(e.email," (").concat(e.strategy,")"),value:e}}));case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),a.handleUserChanged=function(e){a.setState({selectedUser:e,displayStrategy:e&&e.__isNew__,selectedStrategy:a.state.strategies[0]})},a.handleStrategyChanged=function(e){return a.setState({selectedStrategy:e})},a}return Object(w.a)(t,e),Object(v.a)(t,[{key:"componentDidMount",value:function(){this.props.fetchRoles(),this.loadStrategies(),this.loadUsers()}},{key:"componentDidUpdate",value:function(e){!e.isOpen&&this.props.isOpen&&this.emailInput.focus(),!e.roles.length&&this.props.roles.length&&this.setState({role:this.props.roles[0].id})}},{key:"loadStrategies",value:function(){var e=Object(u.a)(c.a.mark(function e(){var t,a;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,le.getAnonymous().get("/auth/config");case 2:t=e.sent,a=t.data,this.setState({strategies:a.payload.strategies.map(function(e){return{label:e.strategyId,value:e.strategyId}})});case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"loadUsers",value:function(){var e=Object(u.a)(c.a.mark(function e(){var t,a;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,le.getSecured().get("/admin/users/listAvailableUsers");case 2:t=e.sent,a=t.data,this.setState({users:a.payload});case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"renderCreatable",value:function(){var e=this;return r.a.createElement(vn.a,{cacheOptions:!0,defaultOptions:!0,ref:function(t){e.emailInput=t},value:this.state.selectedOption,loadOptions:this.findUsers,onChange:this.handleUserChanged})}},{key:"renderStrategies",value:function(){return r.a.createElement(zt.a,{options:this.state.strategies,onChange:this.handleStrategyChanged,value:this.state.selectedStrategy})}},{key:"render",value:function(){var e=this;return r.a.createElement(Ca.a,{isOpen:this.props.isOpen,toggle:this.props.toggleOpen},r.a.createElement(Ra.a,{toggle:this.props.toggleOpen},"Add Collaborator"),r.a.createElement(Sa.a,null,r.a.createElement("form",{onSubmit:this.createUser,ref:function(t){e.formEl=t}},r.a.createElement(Ue.a,null,r.a.createElement(Kt.a,{for:"email"},"E-mail"),this.renderCreatable()),this.state.displayStrategy&&r.a.createElement(Ue.a,null,r.a.createElement(Kt.a,{for:"strategy"},"Authentication Strategy"),this.renderStrategies()),r.a.createElement(Ue.a,null,r.a.createElement(Kt.a,{for:"role"},"Role"),r.a.createElement(Le.a,{required:!0,type:"select",value:this.state.role,onChange:this.onRoleChange},this.props.roles.map(function(e){return r.a.createElement("option",{value:e.id,key:e.id},e.name)}))),r.a.createElement(Ve.a,{className:"float-right",type:"submit",color:"primary",disabled:!this.isFormValid()},r.a.createElement(gt.f,null)," Add"))))}}]),t}(n.Component),yn={fetchRoles:et},wn=Object(f.b)(function(e){return{roles:e.roles.roles}},yn)(bn),kn=hn.a.string().email().trim(),On=function(e){function t(){var e,a;Object(E.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(b.a)(this,(e=Object(y.a)(t)).call.apply(e,[this].concat(r)))).state={isCreateUserModalOpen:!1,isRenderEmailModalOpen:!1,isUpdateRoleModalOpen:!1,email:"",isRoleChanged:!1,user:null,createUserError:null},a.loadAuthStrategy=Object(u.a)(c.a.mark(function e(){var t,n;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,le.getAnonymous().get("/auth/config");case 2:t=e.sent,n=t.data,a.setState({authStrategy:n.payload.strategy});case 5:case"end":return e.stop()}},e,this)})),a.toggleCreateUserModalOpen=function(){a.setState({isCreateUserModalOpen:!a.state.isCreateUserModalOpen,email:"",error:null})},a.toggleRenderEmailModal=function(){a.setState({isRenderEmailModalOpen:!a.state.isRenderEmailModalOpen})},a.toggleUpdateUserModal=function(e){var t=!a.state.isUpdateRoleModalOpen;e?a.setState({isUpdateRoleModalOpen:t,user:e}):a.setState({isUpdateRoleModalOpen:t})},a.onInputKeyPress=function(e){return"Enter"===e.key&&a.createUser()},a.onNewUserEmailChange=function(e){var t=hn.a.validate(e.target.value,kn).error;a.setState({email:e.target.value,canCreateUser:!t,createUserError:t})},a.onUserCreated=function(e){var t="Your botpress account is ready! \n\n      Sign-in here: ".concat(window.location.origin,"/admin/login\n      Email: ").concat(e.email,"\n      Password: ").concat(e.tempPassword);a.setState({isCreateUserModalOpen:!1,isRenderEmailModalOpen:!0,emailSubject:"Account creation successful",emailMessage:t}),a.props.fetchUsers()},a.onUserAdded=function(){a.setState({isCreateUserModalOpen:!1}),a.props.fetchUsers()},a.updateUser=Object(u.a)(c.a.mark(function e(){var t;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.state.user,e.next=3,le.getSecured().put("/admin/users/workspace/update_role",t);case 3:a.setState({isRoleChanged:!1,isUpdateRoleModalOpen:!1,user:null},a.props.fetchUsers);case 4:case"end":return e.stop()}},e,this)})),a.onRoleChange=function(e){var t=e.target.value;a.setState({user:Object(I.a)({},a.state.user,{role:t}),isRoleChanged:!0})},a.onCopy=function(){a.setState({copied:!0}),window.setTimeout(function(){a.setState({copied:!1})},750)},a}return Object(w.a)(t,e),Object(v.a)(t,[{key:"componentDidMount",value:function(){this.loadAuthStrategy(),this.props.fetchRoles()}},{key:"resetPassword",value:function(){var e=Object(u.a)(c.a.mark(function e(t){var a,n,r;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!window.confirm("Are you sure you want to reset ".concat(t.email,"'s password?"))){e.next=7;break}return e.next=3,le.getSecured().get("/admin/users/reset/".concat(t.email));case 3:a=e.sent,n=a.data.payload,r="Your password has been reset.\n     \nEmail: ".concat(t.email,"\nPassword: ").concat(n.tempPassword),this.setState({isRenderEmailModalOpen:!0,emailSubject:"Password reset",emailMessage:r,createUserError:null});case 7:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"removeUser",value:function(){var e=Object(u.a)(c.a.mark(function e(t){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!window.confirm("Are you sure you want to remove ".concat(t.email," from this workspace?"))){e.next=3;break}return e.next=3,le.getSecured().delete("/admin/users/workspace/remove/".concat(t.strategy,"/").concat(t.email));case 3:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"deleteUser",value:function(){var e=Object(u.a)(c.a.mark(function e(t){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!window.confirm("Are you sure you want to delete ".concat(t.email,"'s account?"))){e.next=3;break}return e.next=3,le.getSecured().delete("/admin/users/".concat(t.strategy,"/").concat(t.email));case 3:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"renderUpdateUserModal",value:function(){return r.a.createElement(Ca.a,{isOpen:this.state.isUpdateRoleModalOpen,toggle:this.toggleUpdateUserModal},r.a.createElement(Ra.a,{toggle:this.toggleUpdateUserModal},"Change Role"),r.a.createElement(Sa.a,null,r.a.createElement(Le.a,{type:"select",defaultValue:this.state.user&&this.state.user.role,onChange:this.onRoleChange},this.props.roles.map(function(e){return r.a.createElement("option",{value:e.id,key:"role-"+e.id},e.name)}))),r.a.createElement(Aa.a,null,r.a.createElement(Ve.a,{disabled:!this.state.isRoleChanged,onClick:this.updateUser},"Save")))}},{key:"renderEmailModal",value:function(){return r.a.createElement(Ca.a,{isOpen:this.state.isRenderEmailModalOpen,toggle:this.toggleRenderEmailModal},r.a.createElement(Ra.a,{toggle:this.toggleRenderEmailModal},this.state.emailSubject),r.a.createElement(Sa.a,null,r.a.createElement(Le.a,{type:"textarea",readOnly:!0,style:{height:160},value:this.state.emailMessage})),r.a.createElement(Aa.a,null,r.a.createElement(wa.CopyToClipboard,{text:this.state.emailMessage,onCopy:this.onCopy},r.a.createElement(Ve.a,null,this.state.copied?"Copied!":"Copy to clipboard"))))}},{key:"renderAllUsers",value:function(){var e=this,t={label:"Reset Password",type:"link",onClick:function(t){return e.resetPassword(t)}},a={label:"Delete",type:"link",needRefresh:!0,onClick:function(t){return e.deleteUser(t)}},n={label:"Remove from workspace",type:"link",needRefresh:!0,onClick:function(t){return e.removeUser(t)}},s={label:"Change Role",type:"link",needRefresh:!0,onClick:function(t){return e.toggleUpdateUserModal(t)}},o="basic"===this.state.authStrategy?[t,s,a,n]:[s,a,n];return r.a.createElement("div",null,r.a.createElement(gn,{actions:o,detailed:"true"}))}},{key:"renderSideMenu",value:function(){return r.a.createElement("div",null,r.a.createElement(Ve.a,{className:"float-right",color:"primary",size:"sm",onClick:this.toggleCreateUserModalOpen},r.a.createElement(gt.f,null)," Add Collaborator"),r.a.createElement(wn,{isOpen:this.state.isCreateUserModalOpen,toggleOpen:this.toggleCreateUserModalOpen,onUserCreated:this.onUserCreated,onUserAdded:this.onUserAdded}),this.renderEmailModal(),this.renderUpdateUserModal())}},{key:"render",value:function(){return r.a.createElement(qt,{title:"Collaborators",helpText:"Create, delete users or update their role.",activePage:"users",mainContent:this.renderAllUsers(),sideMenu:this.renderSideMenu()})}}]),t}(n.Component),Cn={fetchUsers:be,fetchRoles:et},Rn=Object(f.b)(function(e){return{loading:e.user.loadingUsers,roles:e.roles.roles}},Cn)(On),Sn=function(e){function t(){return Object(E.a)(this,t),Object(b.a)(this,Object(y.a)(t).apply(this,arguments))}return Object(w.a)(t,e),Object(v.a)(t,[{key:"componentDidMount",value:function(){this.props.fetchRoles()}},{key:"renderRoles",value:function(){return r.a.createElement("div",{className:"bp_table"},this.props.roles.map(function(e){return r.a.createElement("div",{className:"bp_table-row",key:e.id},r.a.createElement("div",{className:"title"},e.name),r.a.createElement("p",null,e.description))}))}},{key:"render",value:function(){return r.a.createElement(qt,{title:"Roles",helpText:"To change roles, please see \u201croles\u201d in the workspaces.json file.",activePage:"roles",currentTeam:this.props.team,mainContent:this.renderRoles()})}}]),t}(n.Component),An={fetchRoles:et},xn=Object(f.b)(function(e){return{roles:e.roles.roles}},An)(Sn),In=function(e){var t=[{name:"Bots",route:"/workspace/bots",icon:r.a.createElement(gt.a,null),component:mn,res:"admin.bots.*",op:"read",size:11},{name:"Collaborators",route:"/workspace/users",icon:r.a.createElement(gt.o,null),component:Rn,res:"admin.collaborators.*",op:"read",proOnly:!0},{name:"Roles",route:"/workspace/roles",icon:r.a.createElement(gt.t,null),component:xn,res:"admin.roles.*",op:"read",proOnly:!0}];return r.a.createElement(kt,Object(I.a)({title:"Workspace",tabs:t},e))},Nn=function(e){function t(){var e,a;Object(E.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(b.a)(this,(e=Object(y.a)(t)).call.apply(e,[this].concat(r)))).state={isModalOpen:!1,password:"",newPassword:"",confirmPassword:"",error:void 0},a.toggleModal=function(){a.setState({isModalOpen:!a.state.isModalOpen})},a.onInputKeyPress=function(e){"Enter"===e.key&&a.changePassword()},a.onInputChange=function(e){a.setState(Object(je.a)({},e.target.name,e.target.value))},a}return Object(w.a)(t,e),Object(v.a)(t,[{key:"changePassword",value:function(){var e=Object(u.a)(c.a.mark(function e(){var t,a,n=this;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.state.newPassword===this.state.confirmPassword){e.next=3;break}return this.setState({error:"Passwords don't match"}),e.abrupt("return");case 3:return t=this.props.profile.strategyType,a=this.props.profile.strategy,e.next=7,le.getSecured().post("/auth/login/".concat(t,"/").concat(a),{email:this.props.profile.email,password:this.state.password,newPassword:this.state.newPassword}).then(function(){return n.toggleModal()}).catch(function(e){return n.setState({error:e.message})});case 7:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"renderModal",value:function(){var e=this;return r.a.createElement(Ca.a,{isOpen:this.state.isModalOpen,toggle:this.toggleModal},r.a.createElement(Ra.a,{toggle:this.toggleModal},"Change your password"),r.a.createElement(Sa.a,null,this.state.error&&r.a.createElement(Fe.a,{color:"danger"},this.state.error),r.a.createElement(Ue.a,null,r.a.createElement(Kt.a,{for:"firstName"},"Current Password"),r.a.createElement(Le.a,{name:"password",type:"password",onChange:this.onInputChange,onKeyPress:this.onInputKeyPress,value:this.state.firstName})),r.a.createElement(Ue.a,null,r.a.createElement(Kt.a,{for:"lastName"},"New Password"),r.a.createElement(Le.a,{value:this.state.newPassword,type:"password",name:"newPassword",onChange:this.onInputChange,onKeyPress:this.onInputKeyPress})),r.a.createElement(Ue.a,null,r.a.createElement(Kt.a,{for:"lastName"},"Confirm Password"),r.a.createElement(Le.a,{value:this.state.confirmPassword,type:"password",name:"confirmPassword",onChange:this.onInputChange,onKeyPress:this.onInputKeyPress}))),r.a.createElement(Aa.a,null,r.a.createElement(Ve.a,{color:"primary",onClick:function(){return e.changePassword()}},"Change")))}},{key:"render",value:function(){return r.a.createElement("div",{className:"profile__change-pwd"},r.a.createElement(Ve.a,{color:"primary",size:"sm",onClick:this.toggleModal},"Change Password"),this.renderModal())}}]),t}(n.Component),jn=Object(f.b)(function(e){return{profile:e.user.profile}})(Nn),Pn=function(e){function t(){var e,a;Object(E.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(b.a)(this,(e=Object(y.a)(t)).call.apply(e,[this].concat(r)))).state={isInit:!1,forceClose:!1,firstName:"",lastName:"",isDirty:!1},a.displayName=function(){var e=a.props.profile,t=e.firstname,n=void 0===t?"":t,r=e.lastname,s=void 0===r?"":r;a.setState({firstName:n,lastName:s})},a.closeModal=function(){a.setState({forceClose:!0})},a.isModalOpen=function(){return!a.state.forceClose&&!M.a.get(a.props,"profile.fullName")},a.onInputKeyPress=function(e){"Enter"===e.key&&a.updateProfile()},a.onInputChanged=function(e){var t;a.setState((t={},Object(je.a)(t,e.target.name,e.target.value),Object(je.a)(t,"isDirty",!0),t))},a.render=function(){return a.props.renderAsModal?a.renderModal():a.renderForm()},a}return Object(w.a)(t,e),Object(v.a)(t,[{key:"componentDidMount",value:function(){this.props.profile&&this.displayName()}},{key:"componentDidUpdate",value:function(e){!e.profile&&this.props.profile&&this.displayName()}},{key:"updateProfile",value:function(){var e=Object(u.a)(c.a.mark(function e(){var t=this;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,le.getSecured().post("/auth/me/profile",{firstname:this.state.firstName,lastname:this.state.lastName});case 2:this.props.fetchProfile(),this.setState({forceClose:!0,successMsg:"Profile updated with success",isDirty:!1}),window.setTimeout(function(){t.setState({successMsg:void 0})},2e3);case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"renderFields",value:function(){return r.a.createElement("div",null,r.a.createElement(Ue.a,null,r.a.createElement(Kt.a,{for:"firstName"},"First Name"),r.a.createElement(Le.a,{name:"firstName",onChange:this.onInputChanged,onKeyPress:this.onInputKeyPress,value:this.state.firstName})),r.a.createElement(Ue.a,null,r.a.createElement(Kt.a,{for:"lastName"},"Last Name"),r.a.createElement(Le.a,{name:"lastName",onChange:this.onInputChanged,onKeyPress:this.onInputKeyPress,value:this.state.lastName})))}},{key:"renderForm",value:function(){return r.a.createElement("div",null,this.state.successMsg?r.a.createElement(Fe.a,{type:"success"},this.state.successMsg):"",this.renderFields(),this.renderSave())}},{key:"renderModal",value:function(){return r.a.createElement(Ca.a,{isOpen:this.isModalOpen(),toggle:this.closeModal},r.a.createElement(Ra.a,{toggle:this.closeModal},"Please complete your profile"),r.a.createElement(Sa.a,null,this.renderFields()),r.a.createElement(Aa.a,null,this.renderSave()))}},{key:"renderSave",value:function(){var e=this;return this.state.isDirty&&r.a.createElement(Ve.a,{color:"primary",onClick:function(){return e.updateProfile()}},"Save")}}]),t}(n.Component),Tn=Object(f.b)(function(e){return{profile:e.user.profile}},function(e){return Object(Je.b)({fetchProfile:ye},e)})(Pn),Bn=function(e){function t(){var e,a;Object(E.a)(this,t);for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return(a=Object(b.a)(this,(e=Object(y.a)(t)).call.apply(e,[this].concat(s)))).state={loading:!1},a.renderBody=function(){return a.props.profile&&r.a.createElement(dt.a,null,r.a.createElement(mt.a,null,r.a.createElement(pt.a,{sm:"12",md:"3",className:"profile"},r.a.createElement(Ce,{email:a.props.profile.email,size:"lg",className:"profile__picture"}),r.a.createElement("p",null,"We use ",r.a.createElement("a",{href:"https://gravatar.com"},"gravatar")," to display profile pictures"),r.a.createElement(jn,null)),r.a.createElement(pt.a,{sm:"12",md:"6"},r.a.createElement(Tn,null))))},a}return Object(w.a)(t,e),Object(v.a)(t,[{key:"render",value:function(){return this.state.loading?r.a.createElement(Wt,null):this.renderBody()}}]),t}(n.Component),Mn=Object(f.b)(function(e){return{profile:e.user.profile}})(Bn),Dn=function(e){var t=[{name:"My Profile",route:"/profile/me",icon:r.a.createElement(gt.p,null),component:Mn}];return r.a.createElement(kt,Object(I.a)({title:"My Account",tabs:t},e,{showHome:!0}))},Fn=a(429),Un=a(260),Ln=a.n(Un),Vn=a(919),Hn=[{label:"Public",value:"public"},{label:"Private",value:"private"},{label:"Disabled",value:"disabled"}],Kn=function(e){function t(){var e,a;Object(E.a)(this,t);for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return(a=Object(b.a)(this,(e=Object(y.a)(t)).call.apply(e,[this].concat(s)))).state={id:"",name:"",avatarUrl:"",coverPictureUrl:"",category:void 0,description:"",website:"",phoneNumber:"",termsConditions:"",emailAddress:"",error:void 0,categories:[],moreOpen:!1,languages:[],defaultLanguage:void 0},a.prepareCategories=function(){a.props.botCategories&&a.setState({categories:a.props.botCategories.map(function(e){return{label:e,value:e}})})},a.updateLanguages=function(){if(a.props.languages){var e=a.props.languages.map(function(e){return{label:e.name,value:e.code}});a.setState({languagesList:e,selectedLanguages:e.filter(function(e){return(a.state.languages||[]).includes(e.value)}),selectedDefaultLang:e.find(function(e){return e.value===a.state.defaultLanguage})})}},a.saveChanges=Object(u.a)(c.a.mark(function e(){var t,n,r,s,o,l,i,u;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a.setState({error:void 0}),t=a.state,n=t.selectedLanguages,r=t.selectedDefaultLang,s=t.category,o={name:a.state.name,description:a.state.description,category:s&&s.value,defaultLanguage:r&&r.value,languages:n&&n.map(function(e){return e.value}),details:{website:a.state.website,phoneNumber:a.state.phoneNumber,termsConditions:a.state.termsConditions,emailAddress:a.state.emailAddress,avatarUrl:a.state.avatarUrl,coverPictureUrl:a.state.coverPictureUrl,privacyPolicy:a.state.privacyPolicy}},l=a.state.status&&a.state.status.value,o.disabled="disabled"===l&&o.defaultLanguage===a.bot.defaultLanguage,o.private="private"===l,i=Ln.a.validate(o,Fn.BotEditSchema),!(u=i.error)){e.next=10;break}return a.setState({error:u}),e.abrupt("return");case 10:return e.next=12,le.getSecured().put("/admin/bots/".concat(a.state.botId),o).catch(function(e){return a.setState({error:e})});case 12:return e.next=14,a.props.fetchBots();case 14:a.setState({successMsg:"Bot configuration updated successfully"}),window.setTimeout(function(){a.setState({successMsg:void 0})},2e3);case 16:case"end":return e.stop()}},e,this)})),a.toggleMoreOpen=function(){a.setState({moreOpen:!a.state.moreOpen})},a.handleInputChanged=function(e){return a.setState(Object(je.a)({},e.target.name,e.target.value))},a.handleStatusChanged=function(e){return a.setState({status:e})},a.handleCategoryChanged=function(e){return a.setState({category:e})},a.handleDefaultLangChanged=function(e){a.state.selectedDefaultLang?a.state.selectedDefaultLang!==e&&window.confirm("Are you sure you want to change the language of your bot from ".concat(a.state.selectedDefaultLang.label," to ").concat(e.label,"? All of your content elements will be copied, make sure you translate them."))&&a.setState({selectedDefaultLang:e}):a.setState({selectedDefaultLang:e})},a.handleLanguagesChanged=function(e){a.setState({selectedLanguages:e})},a.handleCommunityLanguageChanged=function(e){a.setState({selectedDefaultLang:e,selectedLanguages:[e]})},a.handleImageFileChanged=function(){var e=Object(u.a)(c.a.mark(function e(t){var n,r;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.target.name,t.target.files){e.next=3;break}return e.abrupt("return");case 3:if(t.target.files[0].type.includes("image/")){e.next=6;break}return a.setState({error:"".concat(n," requires an image file")}),e.abrupt("return");case 6:return(r=new FormData).append("file",t.target.files[0]),a.state.error&&a.setState({error:null}),e.next=11,le.getSecured().post("/bots/".concat(a.state.botId,"/media"),r,{headers:{"Content-Type":"multipart/form-data"}}).then(function(e){a.setState(Object(je.a)({},n,e.data.url),a.saveChanges)}).catch(function(e){a.setState({error:e})});case 11:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),a.renderLanguages=function(){return a.props.licensing&&a.props.licensing.isPro?r.a.createElement(mt.a,null,r.a.createElement(pt.a,{md:6},r.a.createElement(Ue.a,null,r.a.createElement(Kt.a,{for:"sup-lang"},r.a.createElement("strong",null,"Supported Languages"),a.renderHelp("Your bot can support different languages, select desired languages","sup-lang")),r.a.createElement(zt.a,{options:a.state.languagesList,isMulti:!0,value:a.state.selectedLanguages,onChange:a.handleLanguagesChanged}))),r.a.createElement(pt.a,{md:6},r.a.createElement(Ue.a,null,r.a.createElement(Kt.a,null,r.a.createElement("strong",null,"Default language"),a.renderHelp("Choose the default language for your bot. First of supported language is picked by default.","def-lang")),r.a.createElement(zt.a,{options:a.state.languagesList,value:a.state.selectedDefaultLang,onChange:a.handleDefaultLangChanged})))):r.a.createElement(Ue.a,null,r.a.createElement(Kt.a,{for:"sup-lang"},r.a.createElement("strong",null,"Language"),a.renderHelp("Choose desired language among those","sup-lang")),r.a.createElement(zt.a,{options:a.state.languagesList,value:a.state.selectedLanguages,onChange:a.handleCommunityLanguageChanged}))},a}return Object(w.a)(t,e),Object(v.a)(t,[{key:"componentDidMount",value:function(){this.props.botCategoriesFetched||this.props.fetchBotCategories(),this.props.licensing||this.props.fetchLicensing(),this.props.languages||this.props.fetchLanguages(),this.props.fetchBots(),this.prepareCategories()}},{key:"componentDidUpdate",value:function(e){e.bots!==this.props.bots&&this.loadBot(),e.botCategories!==this.props.botCategories&&this.prepareCategories(),e.languages!==this.props.languages&&this.updateLanguages()}},{key:"loadBot",value:function(){var e=this,t=this.props.match.params.botId;this.bot=this.props.bots.find(function(e){return e.id===t});var a=this.bot.disabled?"disabled":this.bot.private?"private":"public",n=M.a.get(this.bot,"details",{});this.setState({botId:t,name:this.bot.name,description:this.bot.description,languages:this.bot.languages||[],defaultLanguage:this.bot.defaultLanguage,website:n.website,phoneNumber:n.phoneNumber,termsConditions:n.termsConditions,privacyPolicy:n.privacyPolicy,emailAddress:n.emailAddress,status:Hn.find(function(e){return e.value===a}),category:this.state.categories.find(function(t){return t.value===e.bot.category}),avatarUrl:n.avatarUrl||"",coverPictureUrl:n.coverPictureUrl||""},this.updateLanguages)}},{key:"renderHelp",value:function(e,t){return r.a.createElement("span",null,r.a.createElement(gt.h,{id:"help".concat(t),className:"section-title-help"}),r.a.createElement(Yt.a,{placement:"right",target:"help".concat(t)},e))}},{key:"renderDetails",value:function(){return r.a.createElement("div",null,this.state.error&&r.a.createElement(Fe.a,{color:"danger"},this.state.error.message),this.state.successMsg&&r.a.createElement(Fe.a,{type:"success"},this.state.successMsg),r.a.createElement(Vn.a,null,r.a.createElement(mt.a,{form:!0},r.a.createElement(pt.a,{md:5},r.a.createElement(Ue.a,null,r.a.createElement(Kt.a,{for:"name"},r.a.createElement("strong",null,"Name")),r.a.createElement(Le.a,{type:"text",name:"name",value:this.state.name,onChange:this.handleInputChanged}))),r.a.createElement(pt.a,{md:4},!!this.state.categories.length&&r.a.createElement(Ue.a,null,r.a.createElement(Kt.a,null,r.a.createElement("strong",null,"Category")),r.a.createElement(zt.a,{options:this.state.categories,value:this.state.category,onChange:this.handleCategoryChanged}))),r.a.createElement(pt.a,{md:3},r.a.createElement(Ue.a,null,r.a.createElement(Kt.a,{for:"status"},r.a.createElement("strong",null,"Status"),this.renderHelp("Public bots can be accessed by anyone, while private are only accessible by authenticated users. \n                    Please note that private bots cannot be embedded on a website. \n                    This should only be used for testing purposes while developing or if you access it directly using shortlinks")),r.a.createElement(zt.a,{options:Hn,value:this.state.status,onChange:this.handleStatusChanged,isSearchable:!1})))),r.a.createElement(Ue.a,null,r.a.createElement(Kt.a,{for:"description"},r.a.createElement("strong",null,"Description")),r.a.createElement(Le.a,{type:"textarea",name:"description",value:this.state.description,onChange:this.handleInputChanged})),this.renderLanguages()),this.renderCollapsible())}},{key:"renderMoreDetails",value:function(){return r.a.createElement(n.Fragment,null,r.a.createElement(mt.a,{form:!0},r.a.createElement(pt.a,{md:4},r.a.createElement(Ue.a,null,r.a.createElement(Kt.a,{for:"website"},r.a.createElement("strong",null,"Website")),r.a.createElement(Le.a,{type:"text",name:"website",value:this.state.website,onChange:this.handleInputChanged}))),r.a.createElement(pt.a,{md:4},r.a.createElement(Ue.a,null,r.a.createElement(Kt.a,{for:"phoneNumber"},r.a.createElement("strong",null,"Phone Number")),r.a.createElement(Le.a,{type:"text",name:"phoneNumber",value:this.state.phoneNumber,onChange:this.handleInputChanged}))),r.a.createElement(pt.a,{md:4},r.a.createElement(Ue.a,null,r.a.createElement(Kt.a,{for:"emailAddress"},r.a.createElement("strong",null,"Contact E-mail")),r.a.createElement(Le.a,{type:"text",name:"emailAddress",value:this.state.emailAddress,onChange:this.handleInputChanged})))),r.a.createElement(mt.a,{form:!0},r.a.createElement(pt.a,{md:6},r.a.createElement(Ue.a,null,r.a.createElement(Kt.a,{for:"termsConditions"},r.a.createElement("strong",null,"Link to Terms & Conditions")),r.a.createElement(Le.a,{type:"text",name:"termsConditions",value:this.state.termsConditions,onChange:this.handleInputChanged}))),r.a.createElement(pt.a,{md:6},r.a.createElement(Ue.a,null,r.a.createElement(Kt.a,{for:"termsConditions"},r.a.createElement("strong",null,"Link to Privacy Policy")),r.a.createElement(Le.a,{type:"text",name:"privacyPolicy",value:this.state.privacyPolicy,onChange:this.handleInputChanged})))),r.a.createElement("small",null,"These informations are displayed on the Bot Information page,"," ",r.a.createElement("a",{href:"https://botpress.io/docs/tutorials/webchat-embedding",target:"_blank",rel:"noopener noreferrer"},"check the documentation for more details")))}},{key:"renderPictures",value:function(){return r.a.createElement(n.Fragment,null,r.a.createElement(mt.a,null,r.a.createElement(pt.a,{md:7},r.a.createElement(Kt.a,null,r.a.createElement("strong",null,"Bot Avatar")),r.a.createElement(Le.a,{type:"file",accept:"image/*",name:"avatarUrl",onChange:this.handleImageFileChanged})),r.a.createElement(pt.a,{md:4},this.state.avatarUrl&&r.a.createElement("img",{height:75,alt:"avatar",src:this.state.avatarUrl}))),r.a.createElement(mt.a,null,r.a.createElement(pt.a,{md:4},r.a.createElement(Kt.a,null,r.a.createElement("strong",null,"Cover Picture")),r.a.createElement(Le.a,{type:"file",accept:"image/*",name:"coverPictureUrl",onChange:this.handleImageFileChanged})),r.a.createElement(pt.a,{md:8},this.state.coverPictureUrl&&r.a.createElement("img",{width:"100%",alt:"cover",src:this.state.coverPictureUrl}))))}},{key:"renderCollapsible",value:function(){var e=this;return r.a.createElement("div",{className:"bp_users-container"},r.a.createElement("div",null,r.a.createElement("div",{onClick:function(){return e.setState({moreCollapsed:!e.state.moreCollapsed})},className:"bp_users-role_header"},r.a.createElement("div",{className:"role float-left"},r.a.createElement("span",{className:"title"},"More details")),this.state.moreCollapsed?r.a.createElement(gt.k,null):r.a.createElement(gt.i,null))),r.a.createElement(R.a,{isOpen:this.state.moreCollapsed},r.a.createElement("div",{style:{padding:15}},this.renderMoreDetails())),r.a.createElement("div",null,r.a.createElement("div",{onClick:function(){return e.setState({avatarCollapsed:!e.state.avatarCollapsed})},className:"bp_users-role_header"},r.a.createElement("div",{className:"role float-left"},r.a.createElement("span",{className:"title"},"Pictures")),this.state.avatarCollapsed?r.a.createElement(gt.k,null):r.a.createElement(gt.i,null))),r.a.createElement(R.a,{isOpen:this.state.avatarCollapsed},r.a.createElement("div",{style:{padding:15}},this.renderPictures())))}},{key:"render",value:function(){return r.a.createElement(qt,{title:this.state.name||this.state.botId,helpText:"This page shows the details you can configure for a desired bot.",activePage:"bots",currentTeam:this.props.team,mainContent:this.renderDetails(),sideMenu:r.a.createElement(Ve.a,{color:"primary",onClick:this.saveChanges},"Save Details")})}}]),t}(n.Component),zn={fetchBots:Xe,fetchBotCategories:Ge,fetchLicensing:ce,fetchLanguages:function(){return function(){var e=Object(u.a)(c.a.mark(function e(t){var a,n;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,le.getSecured().get("/admin/languages/available");case 2:a=e.sent,n=a.data,t({type:"server/FETCH_LANGUAGES_RECEIVED",languages:n.languages});case 5:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()}},Yn=Object(f.b)(function(e){return{bots:e.bots.bots,botCategories:e.bots.botCategories,botCategoriesFetched:e.bots.botCategoriesFetched,licensing:e.license.licensing,languages:e.server.languages}},zn)(Kn),qn=function(e){var t=[{name:"Settings & Details",route:"/bot/:botId/details",icon:r.a.createElement(gt.a,null),component:Yn,res:"admin.bots.*",op:"write"}];return r.a.createElement(kt,Object(I.a)({title:"Bot Configuration",tabs:t},e,{showHome:!0}))},Zn=function(e){function t(){var e,a;Object(E.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(b.a)(this,(e=Object(y.a)(t)).call.apply(e,[this].concat(r)))).state={},a.reloadModule=function(){var e=Object(u.a)(c.a.mark(function e(t){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,le.getSecured().get("/modules/reload/".concat(t));case 3:a.setState({successMsg:"Module reloaded successfully"}),window.setTimeout(function(){a.setState({successMsg:void 0})},2e3),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}},e,this,[[0,7]])}));return function(t){return e.apply(this,arguments)}}(),a}return Object(w.a)(t,e),Object(v.a)(t,[{key:"componentDidMount",value:function(){this.props.fetchModules()}},{key:"render",value:function(){var e=this;return r.a.createElement(dt.a,{style:{marginTop:50,padding:20}},this.state.successMsg&&r.a.createElement(Fe.a,{type:"success"},this.state.successMsg),r.a.createElement("h3",null,"Module Reloading"),r.a.createElement("div",{className:"bp_table "},this.props.modules.map(function(t){return r.a.createElement("div",{className:"bp_table-row"},r.a.createElement("div",{className:"actions"},r.a.createElement(Ve.a,{color:"primary",size:"sm",onClick:function(){return e.reloadModule(t.name)}},"Reload")),r.a.createElement("div",{className:"title"},t.name))})))}}]),t}(r.a.Component),Jn=Object(f.b)(function(e){return Object(I.a)({},e.modules)},{fetchModules:function(){return function(){var e=Object(u.a)(c.a.mark(function e(t){var a,n;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,le.getSecured().get("/modules");case 2:a=e.sent,n=a.data,t({type:"bots/FETCH_MODULES_RECEIVED",modules:n});case 5:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()}})(Zn),_n=function(e){function t(){var e,a;Object(E.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(b.a)(this,(e=Object(y.a)(t)).call.apply(e,[this].concat(r)))).state={hasWorkspace:!1},a}return Object(w.a)(t,e),Object(v.a)(t,[{key:"componentDidMount",value:function(){this.loadWorkspaces()}},{key:"loadWorkspaces",value:function(){var e=Object(u.a)(c.a.mark(function e(){var t,a;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,le.getSecured().get("/auth/me/workspaces");case 2:t=e.sent,(a=t.data).length&&(_(a[0].workspace),this.setState({hasWorkspace:!0}));case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){return this.state.hasWorkspace?r.a.createElement(m.a,{to:"/"}):r.a.createElement("div",{className:"centered-container"},r.a.createElement("div",{className:"middle"},r.a.createElement("div",{className:"inner"},r.a.createElement("img",{className:"logo",src:Be.a,alt:"loading"}),r.a.createElement(He.a,{body:!0},r.a.createElement(Ke.a,{className:"login-box"},"Sorry, you don't have access to any workspace.")))))}}]),t}(n.Component),Qn=function(){var e=new G;return r.a.createElement(f.a,{store:ct},r.a.createElement(g.a,{history:H},r.a.createElement(p.a,null,r.a.createElement(h.a,{path:"/login/:strategy?/:workspace?",render:function(t){return r.a.createElement(ze,Object.assign({auth:e},t))}}),r.a.createElement(h.a,{path:"/register/:strategy?/:workspace?",render:function(t){return r.a.createElement(Ye,Object.assign({auth:e},t))}}),r.a.createElement(h.a,{path:"/setToken",component:function(){var t,a=Object(n.useState)(!1),s=Object(d.a)(a,2),o=s[0],l=s[1];return e.setSession({expiresIn:7200,idToken:(t="userToken",("; "+document.cookie).split("; ".concat(t,"=")).pop().split(";").shift())}),Object(n.useEffect)(function(){!function(){var t=Object(u.a)(c.a.mark(function t(){return c.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.setupWorkspace();case 3:l(!0),t.next=9;break;case 6:t.prev=6,t.t0=t.catch(0),window.location="/admin/pickWorkspace";case 9:case"end":return t.stop()}},t,this,[[0,6]])}));return function(){return t.apply(this,arguments)}}()()}),o?r.a.createElement(m.a,{to:"/"}):null}}),r.a.createElement(h.a,{path:"/changePassword",render:function(t){return r.a.createElement(qe,Object.assign({auth:e},t))}}),r.a.createElement(h.a,{path:"/pickWorkspace",render:function(t){return r.a.createElement(_n,Object.assign({auth:e},t))}}),r.a.createElement(Ze,{path:"/",auth:e,component:Ne},r.a.createElement(p.a,null,r.a.createElement(h.a,{path:"/profile",component:Dn}),r.a.createElement(h.a,{path:"/confusion",component:Lt}),r.a.createElement(h.a,{path:"/workspace",component:In}),r.a.createElement(h.a,{path:"/server",component:Ya}),r.a.createElement(h.a,{path:"/bot",component:qn}),r.a.createElement(h.a,{path:"/debug",component:la}),r.a.createElement(h.a,{path:"/modules",component:Jn}),r.a.createElement(m.a,{from:"/",to:"/workspace/bots"}))))))}();o.a.render(r.a.createElement("div",null,r.a.createElement(l.ToastContainer,null),Qn),document.getElementById("root"))},94:function(e,t){e.exports="data:image/png;base64,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"}},[[455,1,2]]]);