//CHECKSUM:acc15a90ef3e6ccf509b642eb79f8bb815aed94f6792999d321364f701fa3922
{"version":3,"sources":["../hooks/before_incoming_middleware/.06_rasa_nlu.js"],"names":["axios","require","eventTypes","rasaExtract","includes","event","type","data","post","q","preview","nlu","intent","name","setFlag","bp","IO","WellKnownFlags","SKIP_NATIVE_NLU"],"mappings":";;AAAA;;;;AAKA,MAAMA,KAAK,GAAGC,OAAO,CAAC,OAAD,CAArB;;AAEA,MAAMC,UAAU,GAAG,CAAC,MAAD,CAAnB,C,CAA4B;;AAE5B,eAAeC,WAAf,GAA6B;AAC3B,MAAID,UAAU,CAACE,QAAX,CAAoBC,KAAK,CAACC,IAA1B,CAAJ,EAAqC;AACnC,UAAM;AAAEC,MAAAA;AAAF,QAAW,MAAMP,KAAK,CAACQ,IAAN,CACrB,iCADqB,EAErB;AAAEC,MAAAA,CAAC,EAAEJ,KAAK,CAACK;AAAX,KAFqB,CAAvB;;AAIA,QAAIH,IAAJ,EAAU;AACR;;AAEAF,MAAAA,KAAK,CAACM,GAAN,GAAYN,KAAK,CAACM,GAAN,IAAa,EAAzB,CAHQ,CAIR;;AACAN,MAAAA,KAAK,CAACM,GAAN,CAAUC,MAAV,GAAmB,EAAnB;AACA,UAAGL,IAAI,CAACK,MAAL,CAAYC,IAAf,EACCR,KAAK,CAACM,GAAN,CAAUC,MAAV,CAAiBC,IAAjB,GAAwBN,IAAI,CAACK,MAAL,CAAYC,IAApC,CADD,KAGLR,KAAK,CAACM,GAAN,CAAUC,MAAV,CAAiBC,IAAjB,GAAwB,MAAxB,CATa,CAUR;AACA;AACA;AACA;;AACAR,MAAAA,KAAK,CAACS,OAAN,CAAcC,EAAE,CAACC,EAAH,CAAMC,cAAN,CAAqBC,eAAnC,EAAoD,IAApD;AACD;AACF;AACF;;AAED,OAAOf,WAAW,EAAlB","sourceRoot":"/var/lib/jenkins/workspace/build-linux/modules/builtin/src/backend","sourcesContent":["/**\n * This is an example of how to use Rasa NLU instead of Botpress NLU\n * To enable this, remove the 'dot' before the name of this file\n */\n\nconst axios = require('axios')\n\nconst eventTypes = ['text'] // Process only 'text' events\n\nasync function rasaExtract() {\n  if (eventTypes.includes(event.type)) {\n    const { data } = await axios.post(\n      'http://142.93.216.68:5000/parse',\n      { q: event.preview }\n\t)\n    if (data) {\n      /** TODO Here you will need to manipulate the format of these objects\n       * so that they use the same format as Botpress NLU */\n      event.nlu = event.nlu || {}\n      //event.nlu.intents = data.intent_ranking;\n      event.nlu.intent = {};\n      if(data.intent.name)\n      \tevent.nlu.intent.name = data.intent.name;\n      else\n\tevent.nlu.intent.name = 'none'; \n      //event.nlu.entities = data.entities\n      //event.nlu.language = data.results.language\n      //event.nlu.sentiment = data.results.sentiment\n      // Disable Native NLU\n      event.setFlag(bp.IO.WellKnownFlags.SKIP_NATIVE_NLU, true)\n    }\n  }\n}\n\nreturn rasaExtract()\n"]}